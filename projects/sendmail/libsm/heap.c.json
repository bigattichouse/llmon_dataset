{"project":"sendmail","module":"libsm\/heap.c","summary":"A debugging memory allocation package for sendmail that provides wrappers around standard memory functions (malloc, realloc, free) with additional error checking, memory tracking, and debugging capabilities. The module supports conditional heap checking, memory usage limits, and detailed heap reporting.","logs":[{"function":"sm_malloc_x","message_template":"out of memory","reason":"Raised when memory allocation fails due to insufficient memory available in the system","resolution":"Increase system memory, reduce memory usage in the application, or check for memory leaks"},{"function":"sm_heap_register","message_template":"sm_heap_register: ptr %p is already registered (%s:%d)","reason":"Detected when an attempt is made to register a memory block that's already registered, indicating a potential double allocation or memory management bug","resolution":"Fix the application code that's attempting to allocate the same memory location twice, as this indicates a logic error that could lead to memory corruption"},{"function":"sm_realloc","message_template":"sm_realloc: bad argument (%p)","reason":"Called with a pointer that wasn't allocated by sm_malloc or is invalid, indicating improper memory management","resolution":"Find and fix code that's attempting to realloc memory that wasn't properly allocated, as this can lead to memory corruption or crashes"},{"function":"sm_realloc_x","message_template":"sm_realloc_x: bad argument (%p)","reason":"Called with a pointer that wasn't allocated by sm_malloc or is invalid, indicating improper memory management","resolution":"Find and fix code that's attempting to realloc memory that wasn't properly allocated, as this can lead to memory corruption or crashes"},{"function":"sm_realloc_x","message_template":"out of memory","reason":"Raised when memory reallocation fails due to insufficient memory available in the system","resolution":"Increase system memory, reduce memory usage in the application, or check for memory leaks"},{"function":"sm_free_tagged","message_template":"sm_free: bad argument (%p) (%s:%d)","reason":"Attempt to free memory that wasn't allocated by sm_malloc or was already freed, indicating a double-free condition or use of invalid pointers","resolution":"Debug the code to find where memory is being freed incorrectly or where pointers are used after being freed"},{"function":"sm_heap_checkptr_tagged","message_template":"sm_heap_checkptr(%p): bad ptr (%s:%d)","reason":"Detected when a pointer check fails, indicating the pointer is not currently in the heap (may be invalid or already freed)","resolution":"Find and fix code that's using invalid or previously freed memory pointers"},{"function":"sm_heap_report","message_template":"pid=%ld time=%s\nheap max=%lu, total=%lu, group 0=%lu, group 1=%lu, others=%lu\n","reason":"Generated when heap reporting is enabled, provides memory usage statistics including total heap usage and breakdown by groups","resolution":"Informational log, useful for monitoring memory usage patterns in the application"},{"function":"sm_heap_report","message_template":"BUG => SmHeapTotal: got %lu, expected %lu\n","reason":"Indicates an inconsistency between the calculated total heap size and the tracked heap size, suggesting a bug in the heap tracking code","resolution":"This indicates a bug in the heap tracking mechanism itself. Report to sendmail developers as this suggests memory accounting errors in the heap debugging module"},{"function":"sm_malloc_tagged","message_template":"out of memory","reason":"Occurs when memory allocation fails or when the heap limit is reached in debug mode","resolution":"Increase system memory, adjust heap limit configuration if applicable, or optimize the application to use less memory"},{"function":"sm_malloc_tagged_x","message_template":"out of memory","reason":"Occurs when memory allocation fails or when the heap limit is reached in debug mode, with exception handling","resolution":"Increase system memory, adjust heap limit configuration if applicable, or optimize the application to use less memory"}]}