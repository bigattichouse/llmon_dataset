{"project":"sendmail","module":"..\/working\/sendmail\/test\/t_setuid.c","summary":"This module tests whether the setuid system call works correctly on the system. It verifies that a non-root user can change to another non-root user (uid=1) and that after changing, the program cannot change back to root (uid=0).","logs":[{"function":"printuids","message_template":"%s (should be %d\/%d): r\/euid=%d\/%d\n","reason":"Displays the current real and effective user IDs along with expected values","resolution":"This is an informational log; no resolution required. If the actual values don't match expected values, check the setuid call implementation on the system."},{"function":"main","message_template":"SETUP ERROR: re-run set-user-ID root\n","reason":"Error when the program isn't set-user-ID root. The effective UID must be 0 for the test to run properly.","resolution":"Make sure the program is compiled and set up with the set-user-ID bit and owned by root (chmod u+s and chown root)."},{"function":"main","message_template":"SETUP ERROR: must be run by a non-root user\n","reason":"Error when the program is run by the root user. The test needs to be run by a non-root user to properly test setuid behavior.","resolution":"Run the program as a non-root user to test if a non-privileged user can temporarily gain privileges via setuid."},{"function":"main","message_template":"setuid(1) failure\n","reason":"Error when the setuid(1) call fails, which indicates problems with the setuid implementation.","resolution":"Check system permissions and whether setuid is properly supported. The system may need configuration changes or might need to use setreuid instead."},{"function":"main","message_template":"MAYDAY!  Wrong effective uid\n","reason":"Error when the effective UID doesn't match the expected value after a setuid call, indicating setuid isn't working properly.","resolution":"The system cannot properly set effective UIDs. Consider using setreuid or check for kernel security modules like SELinux or AppArmor that might be blocking UID changes."},{"function":"main","message_template":"MAYDAY!  Wrong real uid\n","reason":"Error when the real UID doesn't match the expected value after a setuid call, indicating setuid isn't properly setting the real UID.","resolution":"The system cannot properly set real UIDs. Consider using setreuid or investigate kernel security settings that might be preventing proper UID changes."},{"function":"main","message_template":"MAYDAY!  setuid(0) succeeded (should have failed)\n","reason":"Error when setuid(0) succeeds for a non-privileged user, which is a security vulnerability allowing unprivileged users to gain root privileges.","resolution":"This indicates a serious security issue with your system's setuid implementation. Update your operating system and consult security documentation for your platform."},{"function":"main","message_template":"setuid(0) failed (this is correct)\n","reason":"Success message when setuid(0) correctly fails, which is the expected behavior for security.","resolution":"Information log, no resolution required. This is the correct behavior that prevents privilege escalation."},{"function":"main","message_template":"This system cannot use setuid (maybe use setreuid)\n","reason":"Final error message when the test determines that setuid doesn't work properly on this system, likely due to security measures or kernel configuration.","resolution":"Configure sendmail to use setreuid instead of setuid, or investigate system permissions and security modules that might be affecting setuid behavior."},{"function":"main","message_template":"It is safe to use setuid on this system\n","reason":"Final success message when the test determines that setuid works correctly and securely on this system.","resolution":"Information log, no resolution required. This indicates sendmail can safely use setuid on this system."}]}