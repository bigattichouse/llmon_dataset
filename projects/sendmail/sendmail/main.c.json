{"project":"sendmail","module":"..\/working\/sendmail\/sendmail\/main.c","summary":"This is the main driver module for sendmail, responsible for processing command line arguments, initializing the system, handling daemon mode operations, managing privileges, and executing core mail delivery functions. It contains extensive error handling and logging for various mail processing actions.","logs":[{"function":"main","message_template":"WARNING: Ignoring submission mode -%c option (not in submission mode)\n","reason":"Warns when a user is trying to use submission mode options in non-submission mode","resolution":"Use the appropriate submission mode when using these options"},{"function":"main","message_template":"WARNING: Ignoring submission mode -%c option with -q\n","reason":"Warns when a user is trying to use submission mode options with queue processing (-q)","resolution":"Don't combine submission mode options with queue processing"},{"function":"main","message_template":"main: reentered!","reason":"Indicates that the main function has been reentered (should never happen)","resolution":"This is a critical error that likely indicates a program logic bug; check for recursive calls to main"},{"function":"main","message_template":"Frozen configurations unsupported\n","reason":"User attempted to use frozen configuration mode which is not supported","resolution":"Use standard configuration methods instead of frozen configurations"},{"function":"main","message_template":"Invalid operation mode %c\n","reason":"User specified an invalid operation mode on the command line","resolution":"Check command-line arguments and use a valid operation mode character"},{"function":"main","message_template":"-D file must be before -d","reason":"Debug mode (-d) was specified before debug file (-D)","resolution":"Rearrange command-line arguments to put -D before -d"},{"function":"main","message_template":"cannot open %s","reason":"Failed to open a specified file, likely a debug file or queue directory","resolution":"Check that the path exists and is writable by the sendmail process"},{"function":"main","message_template":"option requires an argument -- '%c'","reason":"Command-line option was provided without a required argument","resolution":"Provide the required argument for the specified option"},{"function":"main","message_template":"WARNING: Can not use -d with -q.  Disabling debugging.\n","reason":"Debug mode (-d) is not compatible with queue processing (-q) for security reasons","resolution":"Choose either debugging or queue processing, not both"},{"function":"main","message_template":"Unknown UID %d","reason":"Unable to find a user name for the given UID","resolution":"Check that the user exists in the password database"},{"function":"main","message_template":"Version %s\n","reason":"Displays the version when requested with -v","resolution":"Informational message, no resolution required"},{"function":"main","message_template":"Non-set-user-ID binary: RunAsUid = RealUid = %d\n","reason":"Debugging message showing that the binary is not running with set-user-ID permissions","resolution":"Informational message for debugging, no resolution required"},{"function":"main","message_template":"main: e\/ruid = %d\/%d e\/rgid = %d\/%d\n","reason":"Debug logging of effective\/real user and group IDs","resolution":"Informational debug message, no resolution required"},{"function":"main","message_template":"main: RunAsUser = %d:%d\n","reason":"Debug logging of the user\/group ID that sendmail will run as","resolution":"Informational debug message, no resolution required"},{"function":"main","message_template":"Version %s\n Compiled with:","reason":"Shows version and compilation options in verbose mode","resolution":"Informational message, no resolution required"},{"function":"main","message_template":"hostname %s must be ASCII","reason":"The hostname contains non-ASCII characters which is not allowed","resolution":"Configure a hostname that uses only ASCII characters"},{"function":"main","message_template":"uname failed (%s)\n","reason":"The uname system call failed when trying to get system information","resolution":"Check system resources and configuration; this is a low-level system call that rarely fails"},{"function":"main","message_template":"More than one \"from\" person","reason":"Multiple '-f' options were specified on the command line","resolution":"Specify only one sender using the -f option"},{"function":"main","message_template":"Bad hop count (%s)","reason":"The hop count specified with -h is not valid","resolution":"Provide a valid numeric hop count"},{"function":"main","message_template":"Invalid -N argument","reason":"Invalid delivery status notification setting specified","resolution":"Use valid values: 'never', 'success', 'failure', or 'delay'"},{"function":"main","message_template":"Can not use -Q with -b%c","reason":"Quarantine option (-Q) is not compatible with the specified operation mode","resolution":"Don't combine quarantine with incompatible operation modes"},{"function":"main","message_template":"Can not use -q with -b%c","reason":"Queue processing (-q) is not compatible with the specified operation mode","resolution":"Don't combine queue processing with incompatible operation modes"},{"function":"main","message_template":"Can not use -q!G","reason":"Negated queue group mode is not supported","resolution":"Use positive queue group selection instead of negation"},{"function":"main","message_template":"Can not use multiple -qG options","reason":"Multiple queue group options were specified, but only one is allowed","resolution":"Specify only one queue group to process"},{"function":"main","message_template":"Invalid -q value","reason":"The queue interval specification is not valid","resolution":"Provide a valid time interval for queue processing"},{"function":"main","message_template":"Duplicate -R flag","reason":"The DSN RET flag was specified multiple times","resolution":"Specify the -R flag only once"},{"function":"main","message_template":"Invalid -R value","reason":"Invalid value for the DSN RET flag","resolution":"Use 'hdrs' or 'full' as the value for -R"},{"function":"main","message_template":"Invalid syntax in -V flag","reason":"The DSN ENVID syntax is invalid","resolution":"Provide a valid xtext encoded string for the ENVID"},{"function":"main","message_template":"WARNING: SuperSafe=interactive should only be used with\n         DeliveryMode=interactive\n","reason":"SuperSafe is set to interactive but DeliveryMode is not interactive","resolution":"Set DeliveryMode=interactive when using SuperSafe=interactive"},{"function":"main","message_template":"Mail submission program cannot be used as daemon","reason":"Attempting to run in daemon mode while configured as a mail submission program","resolution":"Use separate configurations for submission and daemon roles"},{"function":"main","message_template":"-U requires SMTPUTF8","reason":"UTF8 support is required for the -U option but not compiled in","resolution":"Compile sendmail with SMTPUTF8 support or don't use the -U option"},{"function":"main","message_template":"Can't initialize mailbox database \"%s\": %s","reason":"Failed to initialize the mailbox database","resolution":"Check the mailbox database configuration and permissions"},{"function":"main","message_template":"Mail submission program must have RunAsUser set to non root user","reason":"The mail submission program is trying to run as root, which is a security risk","resolution":"Configure RunAsUser to a non-root user in the sendmail configuration"},{"function":"main","message_template":"Illegal body type %s","reason":"The specified body type (-B option) is not valid","resolution":"Use a valid MIME body type"},{"function":"main","message_template":"Warning: .cf version level (%d) exceeds sendmail version %s functionality (%d)","reason":"The configuration file is from a newer version of sendmail than the binary","resolution":"Update the sendmail binary or use a configuration file compatible with your version"},{"function":"main","message_template":"Warning: HostStatusDirectory disabled with ConnectionCacheSize = 0\n","reason":"HostStatusDirectory requires ConnectionCacheSize to be non-zero","resolution":"Set ConnectionCacheSize to a positive value to use HostStatusDirectory"},{"function":"main","message_template":"Warning: HostStatusDirectory required for SingleThreadDelivery\n","reason":"SingleThreadDelivery requires HostStatusDirectory to be enabled","resolution":"Configure a valid HostStatusDirectory to use SingleThreadDelivery"},{"function":"main","message_template":"cannot get memory statistics, settings ignored, error=%d","reason":"Failed to get memory statistics for memory-based controls","resolution":"Check system configuration and memory access permissions"},{"function":"main","message_template":"Deny user %d attempt to %s\n","reason":"Non-privileged user attempted an operation requiring privileges","resolution":"Run the command as a user with appropriate privileges"},{"function":"main","message_template":"user %d attempted to %s","reason":"Logs unauthorized attempt to perform a privileged operation","resolution":"Use appropriate privileges or authentication for this operation"},{"function":"main","message_template":"Permission denied (real uid not trusted)","reason":"User lacks permission to perform the requested operation","resolution":"Add the user to the trusted users class or run with appropriate privileges"},{"function":"main","message_template":"Drop privs for user %d attempt to expand (RestrictExpand)\n","reason":"Dropping privileges because RestrictExpand is set","resolution":"Informational message, no resolution required"},{"function":"main","message_template":"Faking DontBlameSendmail=NonRootSafeAddr\n","reason":"Debug message about privilege dropping behavior","resolution":"Informational message, no resolution required"},{"function":"main","message_template":"Failed to drop privs for user %d attempt to expand, exiting\n","reason":"Failed to drop privileges when required to do so","resolution":"Check system permissions and configuration; may indicate a security issue"},{"function":"main","message_template":"Deny user %d attempt to rebuild the alias map\n","reason":"Non-privileged user attempted to rebuild aliases","resolution":"Run as a trusted user or with appropriate privileges"},{"function":"main","message_template":"user %d attempted to rebuild the alias map","reason":"Logs unauthorized attempt to rebuild aliases","resolution":"Add the user to the trusted users class or run with appropriate privileges"},{"function":"main","message_template":"User %d cannot rebuild aliases in mail submission program","reason":"Alias rebuilding is not allowed in mail submission mode","resolution":"Use the main sendmail binary, not the submission instance, for alias rebuilding"},{"function":"main","message_template":"Dropping verbosity for user %d (RestrictExpand)\n","reason":"Verbosity is being suppressed due to RestrictExpand being set","resolution":"Informational message, no resolution required"},{"function":"main","message_template":"Notice: -bv may give misleading output for non-privileged user\n","reason":"Address verification may not be accurate for non-root users","resolution":"Run address verification as a privileged user for accurate results"},{"function":"main","message_template":"daemon invoked without full pathname; kill -1 won't work","reason":"Daemon mode was invoked without using a full path, which affects signal handling","resolution":"Use the full path to the sendmail binary when starting in daemon mode"},{"function":"main","message_template":"Warning: .cf file vendor code mismatch: sendmail expects vendor %s, .cf file vendor is %s","reason":"The configuration file is from a different vendor than the binary","resolution":"Use a configuration file from the same vendor as your sendmail binary"},{"function":"main","message_template":"Warning: .cf file is out of date: sendmail %s supports version %d, .cf file is version %d","reason":"The configuration file is from an older version of sendmail","resolution":"Update your configuration file to match the current sendmail version"},{"function":"main","message_template":"WARNING: local host name (%s) is not qualified; see cf\/README: WHO AM I?","reason":"The local hostname lacks a domain component","resolution":"Configure a fully qualified domain name for your system"},{"function":"main","message_template":"No default queue (mqueue) defined","reason":"The default mail queue was not defined in the configuration","resolution":"Define the 'mqueue' queue in your configuration file"},{"function":"main","message_template":"No local mailer defined","reason":"No 'local' mailer was defined in the configuration","resolution":"Define a 'local' mailer in your configuration file"},{"function":"main","message_template":"No prog mailer defined","reason":"No 'prog' mailer was defined in the configuration","resolution":"Define a 'prog' mailer in your configuration file"},{"function":"main","message_template":"No *file* mailer defined","reason":"No '*file*' mailer was defined in the configuration","resolution":"Define a '*file*' mailer in your configuration file"},{"function":"main","message_template":"No *include* mailer defined","reason":"No '*include*' mailer was defined in the configuration","resolution":"Define an '*include*' mailer in your configuration file"},{"function":"main","message_template":"QueueDirectory (Q) option must be set","reason":"No queue directory was specified in the configuration","resolution":"Set the QueueDirectory (Q) option in the sendmail configuration"},{"function":"main","message_template":"Warning: Cannot use HostStatusDirectory = %s: %s\n","reason":"The specified host status directory is not valid","resolution":"Check that the directory exists and has proper permissions"},{"function":"main","message_template":"main: cannot stat %s","reason":"Cannot get status information about a directory or file","resolution":"Check that the path exists and is accessible"},{"function":"main","message_template":"You do not have permission to process the queue","reason":"Non-privileged user attempted to process the queue without permission","resolution":"Run as root, queue owner, or a trusted user"},{"function":"main","message_template":"Queue group %s unknown","reason":"The specified queue group does not exist in the configuration","resolution":"Check the queue group name or define it in the configuration"},{"function":"main","message_template":"Can not use -Q with -q%c","reason":"Quarantine option (-Q) is not compatible with the specified queue option","resolution":"Don't combine quarantine with incompatible queue options"},{"function":"main","message_template":"ERROR: TLS failed to initialize\n","reason":"Failed to initialize TLS\/SSL support","resolution":"Check TLS configuration, certificates, and library installation"},{"function":"main","message_template":"queue control process: lost all children: wait returned ECHILD","reason":"The queue control process lost track of its child processes","resolution":"This may indicate a system resource issue; check for zombie processes"},{"function":"main","message_template":"!sasl_server_init failed! [%s]","reason":"SASL authentication initialization failed","resolution":"Check SASL configuration and libraries"},{"function":"main","message_template":"sm_notify_init() failed=%d","reason":"Failed to initialize notification system","resolution":"Check system resources and notification configuration"},{"function":"main","message_template":"daemon: cannot fork","reason":"Failed to fork daemon process","resolution":"Check system resources and process limits"},{"function":"main","message_template":"starting daemon (%s): %s","reason":"Logs daemon startup information","resolution":"Informational message, no resolution required"},{"function":"main","message_template":"persistent queue runner control process: lost all children: wait returned ECHILD","reason":"The queue process lost track of its child processes","resolution":"Check system resources and process limits"},{"function":"main","message_template":"persistent queue runner=%d core dumped, signal=%d","reason":"A queue processing child crashed with a core dump","resolution":"Examine the core file to determine the cause of the crash"},{"function":"main","message_template":"persistent queue runner=%d died, pid=%ld, signal=%d","reason":"A queue processing child was terminated by a signal","resolution":"Check system logs for more information about the signal"},{"function":"main","message_template":"persistent queue runner=%d, exited","reason":"A queue processing child exited normally","resolution":"Informational message, no resolution required"},{"function":"main","message_template":"connect from %s","reason":"Logs an incoming connection","resolution":"Informational message, no resolution required"},{"function":"main","message_template":"main: where=not_calling_getauthinfo, RealHostAddr=%s, RealHostName=%s","reason":"Debug information about connection authentication","resolution":"Informational debug message, no resolution required"},{"function":"main","message_template":"main: where=after_getauthinfo, RealHostAddr=%s","reason":"Debug information after connection authentication","resolution":"Informational debug message, no resolution required"},{"function":"main","message_template":"%s set sender to %s using -%c","reason":"A user modified the sender using command-line options","resolution":"Authentication warning, may indicate sender forgery attempt"},{"function":"main","message_template":"non-ASCII sender address %s requires SMTPUTF8","reason":"The sender address contains non-ASCII characters but SMTPUTF8 is not enabled","resolution":"Use an ASCII sender address or enable SMTPUTF8 support"},{"function":"main","message_template":"Recipient names must be specified","reason":"No recipients were specified on the command line or in the message","resolution":"Specify at least one recipient for the message"},{"function":"main","message_template":"From person = \"%s\"\n","reason":"Debug information about the sender","resolution":"Informational debug message, no resolution required"},{"function":"intsig","message_template":"interrupt","reason":"Process received an interrupt signal","resolution":"The process was interrupted, likely by a user or system signal"},{"function":"disconnect","message_template":"disconnect: In %d Out %d, e=%p\n","reason":"Debug information about file descriptors during disconnect","resolution":"Informational debug message, no resolution required"},{"function":"disconnect","message_template":"don't\n","reason":"Debug message indicating disconnect was skipped","resolution":"Informational debug message, no resolution required"},{"function":"disconnect","message_template":"disconnect level %d","reason":"Debug message about disconnect level","resolution":"Informational debug message, no resolution required"},{"function":"disconnect","message_template":"disconnect: sm_io_reopen(\"%s\") failed: %s","reason":"Failed to reopen a file descriptor during disconnect","resolution":"Check system resources and file descriptor limits"},{"function":"disconnect","message_template":"disconnect: open(\"%s\") failed: %s","reason":"Failed to open a file during disconnect","resolution":"Check file permissions and system resources"},{"function":"disconnect","message_template":"in background, pid=%d","reason":"Process is now running in the background","resolution":"Informational message, no resolution required"},{"function":"finis","message_template":"finis, pid=%d","reason":"Debug message at process termination","resolution":"Informational debug message, no resolution required"},{"function":"finis","message_template":"xtrap count = %d\n","reason":"Debug information about exception traps","resolution":"Informational debug message, no resolution required"},{"function":"dumpstate","message_template":"--- dumping state on %s: $j = %s ---","reason":"Introduction to a state dump requested for debugging","resolution":"Informational debug message, no resolution required"},{"function":"dumpstate","message_template":"*** $j not in $=w ***","reason":"Warning that the local hostname is not in the class of local hostnames","resolution":"Add your hostname to the 'w' class in the configuration"},{"function":"dumpstate","message_template":"CurChildren = %d","reason":"Debug information about current child processes","resolution":"Informational debug message, no resolution required"},{"function":"dumpstate","message_template":"NextMacroId = %d (Max %d)","reason":"Debug information about macro usage","resolution":"Informational debug message, no resolution required"},{"function":"drop_privileges","message_template":"drop_privileges(%d): Real[UG]id=%ld:%ld, get[ug]id=%ld:%ld, gete[ug]id=%ld:%ld, RunAs[UG]id=%ld:%ld\n","reason":"Debug information about user\/group IDs before dropping privileges","resolution":"Informational debug message, no resolution required"},{"function":"drop_privileges","message_template":"drop_privileges: setgroups(1, %d) failed","reason":"Failed to set the supplementary group list","resolution":"Check system permissions and configuration"},{"function":"drop_privileges","message_template":"drop_privileges: setegid(%d) failed","reason":"Failed to set the effective group ID","resolution":"Check system permissions and configuration"},{"function":"drop_privileges","message_template":"drop_privileges: setregid(%d, %d) failed","reason":"Failed to set the real and effective group IDs","resolution":"Check system permissions and configuration"},{"function":"drop_privileges","message_template":"drop_privileges: setresgid(%d, %d, %d) failed","reason":"Failed to set the real, effective, and saved group IDs","resolution":"Check system permissions and configuration"},{"function":"drop_privileges","message_template":"drop_privileges: setgid(%ld) failed","reason":"Failed to set the group ID","resolution":"Check system permissions and configuration"},{"function":"drop_privileges","message_template":"drop_privileges: Unable to set effective gid=%ld to RunAsGid=%ld","reason":"Failed to properly set the group ID","resolution":"Check system permissions and configuration"},{"function":"drop_privileges","message_template":"drop_privileges: setreuid(%d, -1) failed","reason":"Failed to set the real user ID","resolution":"Check system permissions and configuration"},{"function":"drop_privileges","message_template":"drop_privileges: second setuid(%d) attempt failed","reason":"Failed to set the user ID in a second attempt","resolution":"Check system permissions and configuration"},{"function":"drop_privileges","message_template":"drop_privileges: setuid(%d) failed","reason":"Failed to set the user ID","resolution":"Check system permissions and configuration"},{"function":"drop_privileges","message_template":"drop_privileges: setuid(0) succeeded (when it should not)","reason":"Security issue: non-root process was able to get root privileges","resolution":"This indicates a serious security problem; investigate immediately"},{"function":"drop_privileges","message_template":"drop_privileges: Unable to drop non-root set-user-ID privileges","reason":"Failed to drop privileges properly, creating a security risk","resolution":"This indicates a security problem; check system configuration"},{"function":"drop_privileges","message_template":"drop_privileges: setgid(%d) succeeded (when it should not)","reason":"Security issue: process was able to restore privileged group","resolution":"This indicates a security problem; investigate immediately"},{"function":"sm_setuserenv","message_template":"sm_setuserenv: putenv(%s) failed","reason":"Failed to set an environment variable","resolution":"Check system resources and environment space limits"},{"function":"fill_fd","message_template":"fill_fd: %s: fd %d not open","reason":"File descriptor was not open when expected to be","resolution":"This indicates a potential programming or system configuration issue"},{"function":"fill_fd","message_template":"!fill_fd: %s: cannot open %s","reason":"Failed to open a file during file descriptor setup","resolution":"Check file permissions and system resources"},{"function":"testmodeline","message_template":"Usage: .[DC]macro value(s)\n","reason":"Incorrect usage of test mode commands","resolution":"Provide the correct syntax for the test mode command"},{"function":"testmodeline","message_template":"Unknown \".\" command %s\n","reason":"Unknown test mode command was used","resolution":"Use a valid test mode command"},{"function":"testmodeline","message_template":"Undefined ruleset %s\n","reason":"Referenced a ruleset that doesn't exist","resolution":"Use a defined ruleset name or number"},{"function":"testmodeline","message_template":"Usage: =Sruleset or =M\n","reason":"Incorrect usage of test mode display commands","resolution":"Use the correct syntax for displaying rulesets or mailers"},{"function":"testmodeline","message_template":"Usage: -d{debug arguments}\n","reason":"Incorrect usage of debug commands in test mode","resolution":"Use the correct syntax for debug flags"},{"function":"testmodeline","message_template":"Unknown \"-\" command %s\n","reason":"Unknown debug command in test mode","resolution":"Use a valid debug command"},{"function":"testmodeline","message_template":"Undefined\n","reason":"Referenced an undefined macro in test mode","resolution":"Use a defined macro"},{"function":"testmodeline","message_template":"Usage: \/[canon|map|mx|parse|try|tryflags]\n","reason":"Incorrect usage of test commands","resolution":"Use the correct syntax for test commands"},{"function":"testmodeline","message_template":"No address!\n","reason":"No address provided for testing","resolution":"Provide an address to test"}]}