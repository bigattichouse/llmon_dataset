{"project":"sendmail","module":"domain.c","summary":"This module handles DNS-related operations for the Sendmail system, primarily resolving MX and TLSA records for mail delivery. It includes functions for canonical name lookups, MX record retrieval, DANE security operations, and fallback handling for DNS failures.","logs":[{"function":"tlsainsert","message_template":"func=tlsainsert, i=%d, n=%d, status=exists","reason":"Logs when a TLSA record already exists in the dane_tlsa entry","resolution":"Informational message, no resolution required"},{"function":"tlsainsert","message_template":"func=tlsainsert, i=%d, n=%d, status=inserted","reason":"Logs when a TLSA record is successfully inserted in the dane_tlsa entry","resolution":"Informational message, no resolution required"},{"function":"tlsainsert","message_template":"func=tlsainsert, n=%d, status=appended","reason":"Logs when a TLSA record is appended to the dane_tlsa entry","resolution":"Informational message, no resolution required"},{"function":"tlsainsert","message_template":"func=tlsainsert, n=%d, status=full","reason":"Logs when the dane_tlsa entry is full and cannot accept more TLSA records","resolution":"Consider increasing MAX_TLSA_RR if this occurs frequently"},{"function":"tlsaadd","message_template":"TLSA=%s, records=%d%s","reason":"Logs when only unsupported TLSA records are found for a host","resolution":"Check TLSA records for the domain to ensure they are properly formatted and supported"},{"function":"gettlsa","message_template":"gettlsa: host=%s, flags=%#lx, no ad but Dane=Secure","reason":"Logs when DANE is set to secure but the DNS lookups are not authenticated (no AD flag)","resolution":"Ensure your DNS server supports DNSSEC and is properly configured if using DANE in secure mode"},{"function":"getmxrr","message_template":"getmxrr: res_search(%s) failed (errno=%d (%s), h_errno=%d (%s))","reason":"Logs when DNS lookup for MX records fails with specific error codes","resolution":"Check DNS configuration, ensure DNS servers are reachable, and the domain exists"},{"function":"getmxrr","message_template":"getmxrr: res_search(%s) failed, h_errno=%d","reason":"Logs when DNS lookup for MX records fails with h_errno","resolution":"Verify DNS server configuration and connectivity"},{"function":"getmxrr","message_template":"getmxrr: res_search (%s) failed with impossible h_errno (%d)","reason":"Logs when DNS lookup fails with an unexpected h_errno value","resolution":"This indicates a potential bug in DNS resolution code, contact system administrator"},{"function":"getmxrr","message_template":"found localhost (%s) in MX list, pref=%d","reason":"Logs when localhost is found in the MX list, which might indicate a misconfiguration","resolution":"Check DNS configuration of the domain to ensure proper MX records"},{"function":"getmxrr","message_template":"getmxrr: Null MX record found, domain doesn't accept mail (RFC7505)","reason":"Logs when a Null MX record (RFC7505) is found, indicating the domain doesn't accept mail","resolution":"This is intentional, the domain has explicitly configured not to receive email"},{"function":"getmxrr","message_template":"MX list for %s points back to %s","reason":"Logs an error when MX records point back to the local host after dropping local entries","resolution":"Fix the DNS configuration to ensure MX records don't point to localhost when the local host is handling mail"},{"function":"getmxrr","message_template":"Host name %s too long","reason":"Logs when a host name exceeds the buffer size","resolution":"Use shorter hostnames or increase buffer sizes in the Sendmail configuration"},{"function":"getmxrr","message_template":"Encoded host name %s too long","reason":"Logs when an encoded host name (for internationalized domains) exceeds the buffer size","resolution":"Use shorter internationalized domain names or increase buffer sizes in the configuration"},{"function":"bestmx_map_lookup","message_template":"bestmx_map_lookup: MX host %.64s includes map delimiter character 0x%02X","reason":"Logs an error when an MX host contains a character that conflicts with the map delimiter","resolution":"Change the map delimiter character in the Sendmail configuration to avoid conflicts with hostnames"},{"function":"dns_getcanonname","message_template":"qdcount failure (%d)","reason":"Logs when there's a problem skipping the question portion of a DNS response","resolution":"This usually indicates a problem with the DNS server response format, check DNS server configuration"},{"function":"dns_getcanonname","message_template":"DNS failure: CNAME loop for %s","reason":"Logs a serious error when a CNAME loop is detected during canonical name resolution","resolution":"Fix the DNS configuration to ensure CNAME records don't form a loop"},{"function":"dns_getcanonname","message_template":"Deferred: DNS failure: CNAME loop for %.100s","reason":"Sets a message indicating mail delivery is deferred due to a CNAME loop","resolution":"Check DNS configuration for CNAME loops and break any circular references"}]}