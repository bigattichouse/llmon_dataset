{"project":"sendmail","module":"recipient.c","summary":"Handles email recipient processing, including address validation, aliases, forwarding, and distribution lists. Processes individual and lists of recipients, resolves usernames, and manages security for mail delivery to files, programs, and :include: lists.","logs":[{"function":"sendtolist","message_template":"sendtolist: null list","reason":"Called when sendtolist() is given a NULL list parameter","resolution":"This is likely a programming error. Check the call to sendtolist() to ensure it's not being called with NULL parameters."},{"function":"recipient","message_template":"duplicate suppressed","reason":"A duplicate recipient address was found and suppressed","resolution":"Informational message, no resolution required"},{"function":"recipient","message_template":"aliasing\/forwarding loop broken: %s (%d aliases deep; %d max)","reason":"An aliasing or forwarding loop was detected and broken","resolution":"Check alias and forward files for circular references. Increase MaxAliasRecursion in configuration if appropriate for your environment."},{"function":"recipient","message_template":"554 aliasing\/forwarding loop broken (%d aliases deep; %d max)","reason":"An aliasing or forwarding loop was detected and broken","resolution":"Check alias and forward files for circular references. Increase MaxAliasRecursion in configuration if appropriate for your environment."},{"function":"recipient","message_template":"550 Cannot mail directly to programs","reason":"User attempted to send mail directly to a program without going through an alias","resolution":"Direct program deliveries must be done through an alias for security reasons. Set up an alias that points to the program."},{"function":"recipient","message_template":"550 UID %ld is an unknown user: cannot mail to programs","reason":"Attempted program delivery through an alias with an unknown UID","resolution":"The alias entry is incorrect or the user no longer exists. Update the alias database with a valid user."},{"function":"recipient","message_template":"550 User %s@%s doesn't have a valid shell for mailing to programs","reason":"User has an invalid shell for program delivery","resolution":"The user needs a valid shell listed in \/etc\/shells to receive program deliveries. Update the user's shell or change the alias."},{"function":"recipient","message_template":"550 Unsafe for mailing to programs","reason":"Program delivery was rejected due to security concerns","resolution":"The alias configuration was deemed unsafe. Check file permissions on the alias file and parent directories."},{"function":"recipient","message_template":"550 Address %s is unsafe for mailing to programs","reason":"Program delivery was rejected due to security concerns with specific address","resolution":"The specified address has the QUNSAFEADDR flag set. Check file permissions and ownership related to this address."},{"function":"recipient","message_template":"550 Cannot mail directly to :include:s","reason":"User attempted to send mail directly to an :include: list without going through an alias","resolution":":include: deliveries must be done through an alias for security reasons. Set up an alias that points to the :include: file."},{"function":"recipient","message_template":"including file %s","reason":"An :include: file is being processed","resolution":"Informational message, no resolution required"},{"function":"recipient","message_template":"include %s: transient error: %s","reason":"A temporary error occurred while processing an :include: file","resolution":"Check the specific error message. May be related to file permissions, disk space, or other system resources. The mail will be queued for later delivery."},{"function":"recipient","message_template":"451 4.2.4 Cannot open %s: %s","reason":"A temporary error occurred while trying to open an :include: file","resolution":"Check file permissions and availability. The mail will be queued for later delivery."},{"function":"recipient","message_template":"550 Cannot open %s: %s","reason":"A permanent error occurred while trying to open an :include: file","resolution":"Check if the file exists and has correct permissions. This is a permanent error; the mail will be bounced."},{"function":"recipient","message_template":"550 Cannot mail directly to files","reason":"User attempted to send mail directly to a file without going through an alias","resolution":"Direct file deliveries must be done through an alias for security reasons. Set up an alias that points to the file."},{"function":"recipient","message_template":"550 UID %ld is an unknown user: cannot mail to files","reason":"Attempted file delivery through an alias with an unknown UID","resolution":"The alias entry is incorrect or the user no longer exists. Update the alias database with a valid user."},{"function":"recipient","message_template":"550 User %s@%s doesn't have a valid shell for mailing to files","reason":"User has an invalid shell for file delivery","resolution":"The user needs a valid shell listed in \/etc\/shells to receive file deliveries. Update the user's shell or change the alias."},{"function":"recipient","message_template":"550 Unsafe for mailing to files","reason":"File delivery was rejected due to security concerns","resolution":"The alias configuration was deemed unsafe. Check file permissions on the alias file and parent directories."},{"function":"recipient","message_template":"550 Address %s is unsafe for mailing to files","reason":"File delivery was rejected due to security concerns with specific address","resolution":"The specified address has the QUNSAFEADDR flag set. Check file permissions and ownership related to this address."},{"function":"recipient","message_template":"Deferred: user database error","reason":"A temporary user database error occurred while expanding an address","resolution":"Check the user database for corruption or connectivity issues. The mail will be queued for later delivery."},{"function":"recipient","message_template":"deferred: udbexpand: %s","reason":"A temporary error occurred while expanding a user database entry","resolution":"Check the specific error message. May be related to database connectivity or system resources. The mail will be queued for later delivery."},{"function":"recipient","message_template":"queued (user database error): %s","reason":"Message was queued due to a user database error","resolution":"Check the user database for errors or connectivity issues. The mail will be retried later."},{"function":"recipient","message_template":"554 aliasing\/forwarding loop for %s broken","reason":"An aliasing or forwarding loop was detected and broken for a specific address","resolution":"Check alias and forward files for circular references involving this address. This is a permanent error; the mail will be bounced."},{"function":"recipient","message_template":"554 aliasing\/forwarding loop broken","reason":"An aliasing or forwarding loop was detected and broken","resolution":"Check alias and forward files for circular references. This is a permanent error; the mail will be bounced."},{"function":"recipient","message_template":"sending to login name %s","reason":"A fuzzy match resulted in delivery to a login name","resolution":"Informational message, no resolution required"},{"function":"recipient","message_template":"%s... expanded to multiple addresses","reason":"An address was expanded to multiple recipients","resolution":"Informational message, no resolution required"},{"function":"recipient","message_template":"non-ASCII recipient address %s requires SMTPUTF8","reason":"A non-ASCII address was used without SMTPUTF8 support","resolution":"Use a mail client and server that support SMTPUTF8 for non-ASCII addresses, or use ASCII-only addresses."},{"function":"include","message_template":"include: initgroups(%s, %ld) failed","reason":"Failed to initialize group access list for include file processing","resolution":"Check system resources and permissions. May indicate a system configuration issue or resource limitation."},{"function":"include","message_template":"include: setgroups() failed","reason":"Failed to set group access list for include file processing","resolution":"Check system resources and permissions. May indicate a system configuration issue or resource limitation."},{"function":"include","message_template":"setgid(%ld) failure","reason":"Failed to set group ID for include file processing","resolution":"Check system permissions. May indicate a permissions problem or system resource issue."},{"function":"include","message_template":"seteuid(%ld) failure (real=%ld, eff=%ld)","reason":"Failed to set effective user ID for include file processing","resolution":"Check system permissions. May indicate a permissions problem or system resource issue."},{"function":"include","message_template":"setreuid(0, %ld) failure (real=%ld, eff=%ld)","reason":"Failed to set real and effective user IDs for include file processing","resolution":"Check system permissions. May indicate a permissions problem or system resource issue."},{"function":"include","message_template":"%s: unsafe directory path, marked unsafe","reason":"An include file is in an unsafe directory path","resolution":"Check the directory permissions for the include file. Directories should not be group or world writable."},{"function":"include","message_template":"451 4.4.1 open timeout on %s","reason":"Timed out trying to open an include file","resolution":"Check if the file system containing the include file is responding properly. May be a network file system issue."},{"function":"include","message_template":"Cannot fstat %s!","reason":"Failed to get file status for an include file","resolution":"Check file system for errors or corruption. May indicate a serious system issue."},{"function":"include","message_template":"%s: user %s has bad shell %s, marked %s","reason":"User has an invalid shell for include file processing","resolution":"The user needs a valid shell listed in \/etc\/shells. Update the user's shell or reconfigure the include file."},{"function":"include","message_template":"%s: %s writable %s file, marked unsafe","reason":"An include file is group or world writable","resolution":"Check file permissions for the include file. It should not be group or world writable for security reasons."},{"function":"include","message_template":"forward %.200s => %s","reason":"A message is being forwarded","resolution":"Informational message, no resolution required"},{"function":"include","message_template":"Attempt to forward to more than %d addresses (in %s)!","reason":"Too many forward addresses in a single forward file","resolution":"Reduce the number of forward addresses or increase MaxForwardEntries in the configuration if appropriate."},{"function":"include","message_template":"%s to %s","reason":"A message is being forwarded or sent to an address","resolution":"Informational message, no resolution required"}]}