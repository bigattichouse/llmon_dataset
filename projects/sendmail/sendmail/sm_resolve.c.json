{"project":"sendmail","module":"sm_resolve.c","summary":"This module provides DNS resolution capabilities for Sendmail, including functions to lookup, parse, and convert various DNS record types (A, AAAA, MX, TLSA, etc.). It handles querying nameservers, processing responses, and provides special testing capabilities for DNSSEC.","logs":[{"function":"bin2hex","message_template":"ERROR: bin2hex: size %d wrong","reason":"Indicates an invalid size parameter was provided for binary to hex conversion, likely due to malformed or corrupted DNS data","resolution":"Check the TLSA record data being processed for integrity. This may indicate DNS record corruption or a protocol implementation error."},{"function":"parse_dns_reply","message_template":"parse_dns_reply: fp=%p, e=%d\n","reason":"Debug message indicating a file pointer and error value while saving DNS buffer data","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"parse_dns_reply","message_template":"parse_dns_reply: ac=%d, ad=%d\n","reason":"Debug message showing answer count and AD (authenticated data) flag in DNS reply","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"parse_dns_reply","message_template":"ERROR: DNS RDLENGTH=%d > data len=%d","reason":"The announced size of data in a DNS response exceeds the actual length of the data packet, which suggests DNS response tampering or corruption","resolution":"Check DNS server for integrity or possible DNS-based attacks. This could indicate someone is tampering with DNS responses or a serious DNS server implementation error."},{"function":"parse_dns_reply","message_template":"parse_dns_reply: type=%s, host=%s\n","reason":"Debug message showing record type and hostname in DNS reply","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"parse_dns_reply","message_template":"mx=%s, pref=%d\n","reason":"Debug message showing MX record hostname and preference value","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"parse_dns_reply","message_template":"ERROR: DNS TXT record size=%d <= text len=%d","reason":"Detected inconsistency in TXT record size - the TXT record's text length is greater than or equal to the record size, which should be impossible","resolution":"Check DNS server for proper TXT record formatting. This could indicate DNS record corruption or potential security issues with malformed records."},{"function":"parse_dns_reply","message_template":"parse_dns_reply: TLSA, size=%d, flags=%X\n","reason":"Debug message reporting TLSA record size and flags","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"parse_dns_reply","message_template":"parse_dns_reply: IPv4=%s\n","reason":"Debug message showing an IPv4 address found in DNS response","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"bin2hex","message_template":"len=%d, rr_data=NULL\n","reason":"Debug message indicating memory allocation failure for TLSA record data","resolution":"Check system resources, as this likely indicates a memory allocation failure. The system may be running low on memory."},{"function":"gen_dns_reply","message_template":"gen_dns_reply: dn_comp=%d\n","reason":"Debug message showing domain name compression result value","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"gen_dns_reply","message_template":"gen_dns_reply: query=%s, domain=%s, type=%s, size=%d, ad=%d\n","reason":"Debug message showing DNS query parameters being processed","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"gen_dns_reply","message_template":"gen_dns_reply: ep-cp=%ld\n","reason":"Debug message showing buffer space calculation","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"hex2bin","message_template":"ERROR: hex2bin: size %d wrong","reason":"Indicates an invalid size parameter was provided for hex to binary conversion","resolution":"Check the hex string being converted for proper format. This may indicate data corruption in DNS record processing."},{"function":"hex2bin","message_template":"len=%d, tlsa=NULL\n","reason":"Debug message indicating memory allocation failure for TLSA binary data","resolution":"Check system resources, as this likely indicates a memory allocation failure. The system may be running low on memory."},{"function":"dnscrtrr","message_template":"dnscrtrr rhs=%s h_errno=%d (%s)\n","reason":"Debug message showing DNS resolution error information","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dnscrtrr","message_template":"dnscrtrr: token=%s\n","reason":"Debug message showing token being processed in DNS response creation","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dnscrtrr","message_template":"dnscrtrr: ad=1, adp=%d, adflag=%d\n","reason":"Debug message showing authenticated data flag settings","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dnscrtrr","message_template":"dnscrtrr: ttl=%d\n","reason":"Debug message showing TTL value for DNS record","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dnscrtrr","message_template":"dnscrtrr: mx=%s, pref=%d, rlen=%d\n","reason":"Debug message showing MX record values being processed","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"tstdns_search","message_template":"domain=%s\n","reason":"Debug message showing domain being looked up in test DNS search","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"tstdns_search","message_template":"qdomain=%s\n","reason":"Debug message showing processed domain name in test DNS search","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"tstdns_search","message_template":"access map not found\n","reason":"Error indicating the access map required for simulated DNS lookups was not found","resolution":"Ensure the access map is properly configured in sendmail.cf or access.db is correctly set up. This is needed for DNSSEC test mode to function."},{"function":"tstdns_search","message_template":"access map open failed\n","reason":"Error indicating the access map required for simulated DNS lookups could not be opened","resolution":"Check file permissions and existence of the access map database. Ensure the sendmail user has read access to the database files."},{"function":"tstdns_search","message_template":"access map lookup key=%s, value=%s\n","reason":"Debug message showing access map lookup results","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"tstdns_search","message_template":"access map lookup failed key=%s, try cname\n","reason":"Debug message indicating direct lookup failed, trying CNAME record instead","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"tstdns_search","message_template":"cname lookup key=%s, value=%s, ad=%d\n","reason":"Debug message showing CNAME lookup results in test DNS search","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"tstdns_search","message_template":"access map lookup failed key=%s:%s, but found key=%s\n","reason":"Debug message indicating a specific record type was not found but another type was available","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"tstdns_search","message_template":"access map lookup failed key=%s\n","reason":"Debug message indicating access map lookup completely failed","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"tstdns_search","message_template":"rlen=%d, herr=%d\n","reason":"Debug message showing results length and DNS error code","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dns_lookup_int","message_template":"dns_lookup_int(%s, %d, %s, %x)\n","reason":"Debug message showing DNS lookup parameters","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dns_lookup_int","message_template":"NS=%s, port=%d\n","reason":"Debug message showing nameserver address and port being used","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dns_lookup_int","message_template":"dns_lookup: domain=%s, length=%d, default_size=%d, max=%d, status=response too long\n","reason":"Error indicating DNS response exceeds maximum allowed size, suggesting an unusually large or malformed DNS response","resolution":"Check for DNSSEC records or other large DNS records that might exceed normal limits. Consider increasing buffer sizes or configuring DNS to use TCP for large responses."},{"function":"dns_lookup_int","message_template":"dns_lookup: domain=%s, length=%d, default_size=%d, max=%d, status=response longer than default size, resizing\n","reason":"Warning that DNS response is larger than default buffer size and requires resizing","resolution":"Usually handled automatically by the code. If this appears frequently, consider increasing the default DNS buffer size configuration."},{"function":"dns_lookup_int","message_template":"dns_lookup_int(%s, %d, %s, %x)=%d, errno=%d, h_errno=%d (%s)\n","reason":"Debug message showing detailed DNS lookup failure information with error codes and descriptions","resolution":"Check DNS server configuration and connectivity. Common issues include DNS server unavailability, network issues, or misconfigured zones."},{"function":"dns_lookup_int","message_template":"dns_lookup_int(%s, %d, %s, %x)=%d\n","reason":"Debug message showing DNS lookup result","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dns2he","message_template":"dns2he: ad=%d\n","reason":"Debug message showing authenticated data flag in host entry conversion","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dns2he","message_template":"dns2he: cname: %s ttl=%d\n","reason":"Debug message showing CNAME record details during host entry conversion","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dns2he","message_template":"dns2he: mx: %d %s ttl=%d\n","reason":"Debug message showing MX record details during host entry conversion","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dns2he","message_template":"dns2he: tlsa: %s ttl=%d\n","reason":"Debug message showing TLSA record details during host entry conversion","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dns2he","message_template":"dns2he: addr[%d]: %s\n","reason":"Debug message showing address values in host entry array","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."},{"function":"dns_addns","message_template":"too many NameServers defined (%d max)","reason":"Critical error when attempting to add more nameservers than the system can handle (exceeding MAXNS limit)","resolution":"Reduce the number of nameservers configured in sendmail.cf or adjust the MAXNS value if recompiling sendmail. Default limit is typically 3 nameservers."},{"function":"dns_addns","message_template":"dns_addns: nsidx=%d, ns=%s:%u\n","reason":"Debug message showing nameserver index and address\/port being added","resolution":"Informational debug message, no resolution required. Only appears with high debug levels."}]}