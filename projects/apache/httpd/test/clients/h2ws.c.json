{"module":"h2ws.c","summary":"This module implements a WebSocket client over HTTP\/2 using the nghttp2 library. It supports various test scenarios for WebSocket connections, including deliberately failing ones to test protocol compliance.","logs":[{"function":"parse_uri","message_template":"empty host name in '%.*s","reason":"Logs when a URI has no host specified. This would prevent the client from connecting to any server.","resolution":"Check the URI syntax and ensure a valid hostname is provided."},{"function":"parse_uri","message_template":"invalid port char '%c'","reason":"Logs when a non-numeric character is found in the port segment of a URI.","resolution":"Ensure the port in the URI only contains numeric characters."},{"function":"parse_uri","message_template":"invalid port number '%d'","reason":"Logs when a port number exceeds the valid range (0-65535).","resolution":"Use a port number within the valid range of 0-65535."},{"function":"sock_nonblock_nodelay","message_template":"fcntl get error %d (%s)","reason":"Logs when fcntl() fails to get the socket flags, which is needed to set non-blocking mode.","resolution":"Check system resources, socket health, and permissions. This may indicate system-level issues with the network stack."},{"function":"sock_nonblock_nodelay","message_template":"fcntl set error %d (%s)","reason":"Logs when fcntl() fails to set the socket to non-blocking mode.","resolution":"Verify system resources and socket permissions. Try restarting the application or system if persistent."},{"function":"sock_nonblock_nodelay","message_template":"set nodelay error %d (%s)","reason":"Logs when setsockopt() fails to set TCP_NODELAY, which is used to disable Nagle's algorithm.","resolution":"Check if the socket type supports TCP options and if the system TCP stack is functioning correctly."},{"function":"h2_session_send","message_template":"error sending %ld bytes: %d (%s)","reason":"Logs when the HTTP\/2 session fails to send data due to a socket error.","resolution":"Check network connectivity and server availability. If error persists, it may indicate network configuration issues or server overload."},{"function":"h2_session_recv","message_template":"error reading %ld bytes: %d (%s)","reason":"Logs when the HTTP\/2 session fails to receive data due to a socket error.","resolution":"Verify network connectivity and server health. The connection may have been reset or timed out."},{"function":"frame send","message_template":"FRAME[HEADERS, stream=%d","reason":"Logs when a HEADERS frame is being sent in the HTTP\/2 connection.","resolution":"Informational log, no resolution required."},{"function":"frame send","message_template":"  %.*s: %.*s","reason":"Logs the individual header fields in a HEADERS frame being sent.","resolution":"Informational log, no resolution required."},{"function":"frame send","message_template":"]","reason":"Marks the end of a HEADERS frame log entry.","resolution":"Informational log, no resolution required."},{"function":"frame send","message_template":"FRAME[DATA, stream=%d, length=%d, flags=%d]","reason":"Logs when a DATA frame is being sent in the HTTP\/2 connection.","resolution":"Informational log, no resolution required."},{"function":"frame send","message_template":"FRAME[RST, stream=%d]","reason":"Logs when a RST_STREAM frame is being sent to terminate a stream.","resolution":"Check for errors in the application logic that might have caused the stream to be reset."},{"function":"frame send","message_template":"FRAME[WINDOW_UPDATE, stream=%d]","reason":"Logs when a WINDOW_UPDATE frame is being sent to manage flow control.","resolution":"Informational log, no resolution required."},{"function":"frame send","message_template":"FRAME[GOAWAY]","reason":"Logs when a GOAWAY frame is being sent to terminate the HTTP\/2 connection.","resolution":"Check if the connection is being terminated normally or due to an error condition."},{"function":"frame recv","message_template":"FRAME[HEADERS, stream=%d]","reason":"Logs when a HEADERS frame is received in the HTTP\/2 connection.","resolution":"Informational log, no resolution required."},{"function":"frame recv","message_template":"FRAME[DATA, stream=%d, len=%lu, eof=%d]","reason":"Logs when a DATA frame is received in the HTTP\/2 connection.","resolution":"Informational log, no resolution required."},{"function":"frame recv","message_template":"FRAME[RST, stream=%d]","reason":"Logs when a RST_STREAM frame is received, indicating the peer has terminated a stream.","resolution":"Check for errors in the request or stream handling that might have caused the peer to reset the stream."},{"function":"frame recv","message_template":"FRAME[GOAWAY]","reason":"Logs when a GOAWAY frame is received, indicating the peer is terminating the connection.","resolution":"Check if the server is shutting down or if there was an error in the connection."},{"function":"frame recv","message_template":"stream=%d, HEADER   %.*s: %.*s","reason":"Logs individual header fields received in a HEADERS frame.","resolution":"Informational log, no resolution required."},{"function":"on header recv","message_template":"stream=%d, invalid :status: %.*s","reason":"Logs when an invalid HTTP status code is received in a response.","resolution":"Check if the server is sending a valid HTTP status code or if there's a protocol error."},{"function":"stream close","message_template":"stream %d closed with error %d","reason":"Logs when a stream is closed with an error code.","resolution":"Investigate the error code to determine the cause of the stream closure and fix the related issue."},{"function":"terminate session","message_template":"error %d (%s)","reason":"Logs when there's an error terminating the HTTP\/2 session.","resolution":"Check the error message and ensure proper cleanup of resources. May indicate internal library issues."},{"function":"cmd","message_template":"could not connect to %s:%u","reason":"Logs when the client fails to establish a connection to the server.","resolution":"Verify that the server is running, network connectivity is available, and the hostname and port are correct."},{"function":"cmd","message_template":"connected to %s via %s:%u","reason":"Logs when the client successfully connects to the server.","resolution":"Informational log, no resolution required."},{"function":"setup callbacks","message_template":"error_code=%d, msg=%s\n","reason":"Logs when there's an error setting up the nghttp2 callbacks.","resolution":"Check the error message for details. This is likely a programming or library issue that needs code fixes."},{"function":"client new","message_template":"error_code=%d, msg=%s\n","reason":"Logs when there's an error creating a new nghttp2 client session.","resolution":"Check the error message for details. Might be related to memory allocation or library initialization issues."},{"function":"submit settings","message_template":"error_code=%d, msg=%s\n","reason":"Logs when there's an error submitting HTTP\/2 settings to the server.","resolution":"Check the error message for details. May indicate protocol negotiation issues or incompatibility with the server."},{"function":"set connection window size","message_template":"error_code=%d, msg=%s\n","reason":"Logs when there's an error setting the HTTP\/2 connection window size.","resolution":"Check the error message for details. May indicate flow control configuration issues."},{"function":"session recv","message_template":"error_code=%d, msg=%s\n","reason":"Logs when there's an error receiving data in the HTTP\/2 session.","resolution":"Check the error message and network connectivity. May indicate protocol errors or connection issues."},{"function":"session send","message_template":"error_code=%d, msg=%s\n","reason":"Logs when there's an error sending data in the HTTP\/2 session.","resolution":"Check the error message and network connectivity. May indicate write buffer issues or connection problems."},{"function":"session run","message_template":"connection closed","reason":"Logs when the HTTP\/2 connection is closed, often due to normal termination.","resolution":"If unexpected, check if the server closed the connection prematurely or if there was a network issue."},{"function":"session run","message_template":"connection error","reason":"Logs when there's an error with the HTTP\/2 connection.","resolution":"Check server logs and network status for the underlying cause of the connection error."},{"function":"session run","message_template":"poll error %d (%s)","reason":"Logs when there's an error with the poll() system call used for I\/O multiplexing.","resolution":"Check if the system is low on file descriptors or if there are other resource limitations."},{"function":"cmd","message_template":"closed session to %s:%u","reason":"Logs when the HTTP\/2 session is closed normally.","resolution":"Informational log, no resolution required."},{"function":"ws stream","message_template":"stream %d closed","reason":"Logs when a WebSocket stream is closed.","resolution":"Informational log, no resolution required."},{"function":"ws stream","message_template":"stream %d recv %lu data bytes","reason":"Logs when data is received on a WebSocket stream.","resolution":"Informational log, no resolution required."},{"function":"ws stream create","message_template":"out of memory","reason":"Logs when memory allocation for a new WebSocket stream fails.","resolution":"Check system memory resources and potential memory leaks in the application."},{"function":"stream req body","message_template":"stream not known","reason":"Logs when trying to read the request body for an unknown stream.","resolution":"This may indicate a programming error where a stream ID is being mishandled. Check the application logic."},{"function":"stream req body","message_template":"fread(len=%lu) -> %ld","reason":"Logs the result of reading from the input stream for a request body.","resolution":"Informational log, no resolution required."},{"function":"stream req body","message_template":"error on input","reason":"Logs when there's an error reading the request body from the input stream.","resolution":"Check if the input source (often stdin) is available and readable."},{"function":"ws stream submit","message_template":"nghttp2_submit_request: error %d","reason":"Logs when there's an error submitting a WebSocket request to the HTTP\/2 session.","resolution":"Check the error code and make sure all required headers are properly set for the WebSocket handshake over HTTP\/2."},{"function":"ws stream submit","message_template":"stream %d opened for %s%s","reason":"Logs when a WebSocket stream is successfully opened.","resolution":"Informational log, no resolution required."},{"function":"cmd","message_template":"could not parse connect '%s'","reason":"Logs when the connect argument (-c host:port) cannot be parsed.","resolution":"Check the format of the connect argument and ensure it follows the expected host:port pattern."},{"function":"cmd","message_template":"could not parse uri '%s'","reason":"Logs when the WebSocket URI cannot be parsed.","resolution":"Verify the URI format and ensure it follows the ws:\/\/ or wss:\/\/ scheme patterns with valid host and path components."},{"function":"cmd","message_template":"normalized uri: %s:\/\/%s:%u%s","reason":"Logs the normalized URI after parsing.","resolution":"Informational log, no resolution required."},{"function":"cmd","message_template":"unknown scenario: %s","reason":"Logs when an unknown test scenario is specified.","resolution":"Use one of the supported test scenarios listed in the usage help text."}],"project":"apache\/httpd"}