{"module":"apreq_parser.c","summary":"This module implements a parser for multipart\/form-data content as specified in RFC2065, commonly used for handling file uploads in web applications. It contains a state machine that processes multipart boundaries, extracts headers, parameters, and file contents, supporting nested multipart sections up to a maximum recursion depth.","logs":[{"function":"create_multipart_context","message_template":"Missing semicolon in Content-Type header","reason":"The Content-Type header for multipart data lacks a required semicolon delimiter, making it impossible to parse the boundary parameter","resolution":"Verify the client is sending a properly formatted Content-Type header with a semicolon followed by boundary parameter"},{"function":"create_multipart_context","message_template":"Missing or empty boundary in Content-Type header","reason":"The boundary parameter is either missing or empty in the Content-Type header, making it impossible to parse multipart data correctly","resolution":"Check the client's Content-Type header to ensure it includes a valid boundary parameter"},{"function":"apreq_parse_multipart","message_template":"Failed to create multipart context","reason":"Unable to initialize the parser context, likely due to malformed Content-Type header or boundary parameter","resolution":"Verify the Content-Type header format and ensure it contains a valid boundary parameter"},{"function":"apreq_parse_multipart","message_template":"Maximum recursion level exceeded","reason":"Nested multipart sections have exceeded the maximum allowed recursion depth (MAX_LEVEL)","resolution":"Check if the request contains unusually deep nesting of multipart sections, which could indicate a malformed request or an attack"},{"function":"apreq_parse_multipart","message_template":"Invalid or missing Content-Disposition header","reason":"A required Content-Disposition header is missing or improperly formatted in a multipart section","resolution":"Verify the client's multipart request includes properly formatted Content-Disposition headers for each part"},{"function":"apreq_parse_multipart","message_template":"Missing or invalid 'name' attribute in Content-Disposition","reason":"The 'name' attribute is required in Content-Disposition headers for form-data parts but is missing or invalid","resolution":"Check the client's multipart request to ensure each form-data part has a proper name attribute"},{"function":"apreq_parse_multipart","message_template":"Failed to allocate memory for parameter","reason":"Memory allocation failed when attempting to create a parameter structure for a form field or file upload","resolution":"Check system resources and consider increasing available memory or implementing request size limits"},{"function":"apreq_parse_multipart","message_template":"Brigade manipulation error","reason":"Error occurred during bucket brigade operations like splitting, flattening, or length calculation","resolution":"This could be due to memory constraints or malformed input; consider limiting request size or investigating potential malformed requests"},{"function":"apreq_parse_multipart","message_template":"Hook function returned error status","reason":"A custom hook function registered with the parser returned an error status, stopping the parsing process","resolution":"Check the hook function implementation for errors and verify it's handling the data correctly"},{"function":"apreq_parse_multipart","message_template":"Failed to find expected multipart boundary","reason":"The parser could not find the expected boundary marker in the input data, indicating malformed or incomplete multipart data","resolution":"Verify the client's multipart request is properly formatted with correct boundary markers between parts"},{"function":"apreq_parse_multipart","message_template":"Brigade size limit exceeded","reason":"The size of a bucket brigade exceeded the configured limit during parsing, often indicating an excessively large file upload","resolution":"Consider increasing the brigade limit or implementing stricter file size limits for uploads"},{"function":"split_on_bdry","message_template":"Invalid boundary format in multipart data","reason":"The parser encountered an incorrectly formatted boundary while splitting the multipart content","resolution":"Check if the client is correctly formatting multipart data with proper boundary markers according to RFC specifications"}],"project":"apache\/httpd"}