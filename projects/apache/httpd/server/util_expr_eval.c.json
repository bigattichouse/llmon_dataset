{"module":"ap_expr_eval.c","summary":"This Apache module provides expression evaluation functionality for HTTP server directives. It supports various operations including string manipulation, regular expressions, file checks, and network tests, allowing complex conditional rules to be evaluated at request time.","logs":[{"function":"inc_rec","message_template":"Recursion limit reached","reason":"The expression evaluation has exceeded the maximum allowed recursion depth (20 levels), likely due to a circular reference in the expression.","resolution":"Simplify the expression to avoid deep nesting or circular references. Break complex expressions into smaller parts or use intermediate variables."},{"function":"ap_expr_eval_word","message_template":"Internal evaluation error: Unknown word expression node","reason":"The expression evaluator encountered an unknown expression node type when evaluating a word expression, indicating a possible programming error.","resolution":"This is an internal error that indicates a bug in the Apache code or a corrupted expression tree. Report the issue to Apache maintainers with steps to reproduce."},{"function":"ap_expr_eval_comp","message_template":"Internal evaluation error: Unknown comp expression node","reason":"The expression evaluator encountered an unknown comparison operator, indicating a possible programming error.","resolution":"This is an internal error that indicates a bug in the Apache code. Check the expression syntax and report the issue to Apache maintainers."},{"function":"ap_expr_eval_cond","message_template":"Internal evaluation error: Unknown expression node","reason":"The expression evaluator encountered an unknown node type when evaluating a conditional expression, indicating a programming error.","resolution":"This is an internal error that indicates a bug in the Apache code. Check for invalid expression syntax and report the issue if it persists."},{"function":"ap_expr_yyparse","message_template":"ap_expr_yylex_init error","reason":"Failed to initialize the lexical analyzer for expression parsing, possibly due to memory allocation issues.","resolution":"Check system resources, particularly memory availability. If the issue persists, it may indicate a bug in the Apache code that should be reported."},{"function":"ap_expr_yyparse","message_template":"syntax error","reason":"A syntax error was encountered while parsing an expression, meaning the expression doesn't follow the expected grammar.","resolution":"Check the expression syntax in your configuration. Look for mismatched parentheses, invalid operators, or other syntax problems."},{"function":"ap_expr_exec_ctx","message_template":"Evaluation of string expression from %s:%d failed: %s","reason":"An error occurred while evaluating a string expression, with the specific reason provided in the message.","resolution":"Check the expression in the indicated file and line. The error message should provide specific guidance on what went wrong, such as invalid arguments or syntax."},{"function":"ap_expr_exec_ctx","message_template":"Evaluation of string expression from %s:%d gave: %s","reason":"Debug log showing the result of evaluating a string expression, including the file and line where the expression was defined.","resolution":"Informational log, no resolution required. This is a trace-level debug message to help with configuration debugging."},{"function":"ap_expr_exec_ctx","message_template":"Evaluation of expression from %s:%d failed: %s","reason":"An error occurred while evaluating a boolean expression, with the specific reason provided in the message.","resolution":"Check the expression in the indicated file and line. The error message should provide specific guidance on what went wrong, such as invalid arguments or syntax."},{"function":"ap_expr_exec_ctx","message_template":"Evaluation of expression from %s:%d gave: %d","reason":"Debug log showing the result (true\/false) of evaluating a boolean expression, including the file and line where the expression was defined.","resolution":"Informational log, no resolution required. This is a trace-level debug message to help with configuration debugging."},{"function":"replace_func","message_template":"replace() function needs an argument","reason":"The replace() function was called without any arguments, but it requires at least one argument.","resolution":"Update the expression to provide arguments to the replace() function. The correct format is replace(string, pattern, replacement)."},{"function":"replace_func","message_template":"replace() function needs exactly 3 arguments, got %d","reason":"The replace() function was called with an incorrect number of arguments. It requires exactly 3 arguments: the input string, the pattern to replace, and the replacement text.","resolution":"Update the expression to provide exactly 3 arguments to the replace() function in the format replace(string, pattern, replacement)."},{"function":"file_func","message_template":"Cannot open file %s","reason":"The file() function failed to open the specified file, likely due to insufficient permissions or the file not existing.","resolution":"Check if the file exists and that the Apache process has read permissions for it. Verify the path is correct and accessible from Apache's context."},{"function":"file_func","message_template":"File %s too large","reason":"The file() function tried to read a file that exceeds the maximum allowed size (10MB).","resolution":"Use a smaller file or modify the code to increase the MAX_FILE_SIZE value (requires recompilation). Consider alternative approaches for reading large files."},{"function":"file_func","message_template":"Cannot allocate memory","reason":"The file() function failed to allocate memory for reading the file content, likely due to system resource constraints.","resolution":"Check system memory usage and consider increasing available memory. For large files, consider reading them in chunks or using a different approach."},{"function":"file_func","message_template":"Cannot read from file %s","reason":"The file() function opened the file but failed to read its content, possibly due to I\/O errors or permission issues.","resolution":"Check file permissions and ensure the Apache process has proper read access. Also check for disk errors or other I\/O issues on the system."},{"function":"unescape_func","message_template":"%s %% escape in unescape('%s') at %s:%d","reason":"The unescape() function encountered a problematic percent-escape sequence in the URL string that is either malformed or represents a forbidden character.","resolution":"Check the URL string being unescaped for invalid percent-encoded sequences. The first parameter indicates if it's a 'Bad' format or 'Forbidden' character issue."},{"function":"op_url_subr","message_template":"Subrequest for -U %s at %s:%d gave status: %d","reason":"Debug log showing the HTTP status code returned by a subrequest used to check URL accessibility in the -U operator.","resolution":"Informational log, no resolution required. If checking for expected behavior, verify the status code matches expectations (typically looking for codes < 400)."},{"function":"op_file_subr","message_template":"Subrequest for -F %s at %s:%d gave status: %d","reason":"Debug log showing the HTTP status code returned by a subrequest used to check file accessibility in the -F operator.","resolution":"Informational log, no resolution required. If checking for expected behavior, verify the status code matches expectations (typically looking for codes < 300)."},{"function":"subnet_parse_arg","message_template":"-%s requires subnet\/netmask as constant argument","reason":"An operator that requires a subnet\/netmask argument (like -R) was used without providing the required argument or with a non-constant argument.","resolution":"Update the configuration to provide a valid subnet\/netmask as a constant argument to the operator, e.g., -R 192.168.1.0\/24."},{"function":"subnet_parse_arg","message_template":"parsing of subnet\/netmask failed","reason":"The subnet\/netmask argument provided to an operator (like -R or ipmatch) couldn't be parsed because it has invalid syntax.","resolution":"Check the subnet\/netmask format. It should be in CIDR notation (e.g., 192.168.1.0\/24) or use a dotted-quad netmask. Ensure it's a valid IPv4 or IPv6 address format."},{"function":"core_expr_lookup","message_template":"%s%s not available in restricted context","reason":"A function or operator that is restricted in certain contexts (like in .htaccess files) was used in a restricted context.","resolution":"Avoid using restricted functions in .htaccess files or other restricted contexts. These functions (like file operations) are only available in server or directory configuration contexts for security reasons."},{"function":"expr_lookup_not_found","message_template":"Invalid expression type in expr_lookup","reason":"An internal error occurred where an expression lookup was attempted with an invalid expression type.","resolution":"This is an internal error that indicates a bug in the Apache code. Report the issue to Apache maintainers with steps to reproduce and relevant configuration."},{"function":"expr_lookup_not_found","message_template":"%s '%s%s' does not exist","reason":"A referenced variable, function, or operator does not exist or is not registered with the expression parser.","resolution":"Check the spelling of the function, variable, or operator name. Consult the Apache documentation for the list of available expression components. If using a custom function, ensure it's properly registered."},{"function":"expr_dump_tree","message_template":"%*sERROR: INVALID OP %d","reason":"Debug log indicating an invalid operation code was encountered when dumping the expression tree for debugging.","resolution":"This is an internal error that indicates a bug in the Apache code or a corrupted expression tree. Report the issue to Apache maintainers with steps to reproduce."}],"project":"apache\/httpd"}