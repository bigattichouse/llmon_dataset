{"module":"h2_session.c","summary":"This module manages HTTP\/2 sessions, handling connection-level operations like session initialization, frame processing, stream management, state transitions, and error handling. It interfaces with the nghttp2 library to implement the HTTP\/2 protocol while maintaining connection lifecycle, flow control, and stream prioritization.","logs":[{"function":"h2_session_event","message_template":"h2_session: send error","reason":"Error encountered when trying to send data to the client over the HTTP\/2 connection","resolution":"Check network connectivity and client status. May indicate connection problems or client disconnection."},{"function":"on_invalid_frame_recv_cb","message_template":"recv invalid FRAME[%s], frames=%ld\/%ld (r\/s)","reason":"Server received an invalid HTTP\/2 frame from the client","resolution":"This may indicate a buggy client implementation or a corrupted connection. No action needed unless it occurs frequently with the same client."},{"function":"on_data_chunk_recv_cb","message_template":"write %ld bytes of DATA","reason":"Debug message indicating amount of data being written to a stream","resolution":"Informational message, no resolution required"},{"function":"on_data_chunk_recv_cb","message_template":"on_data_chunk for unknown stream","reason":"Server received data for a stream that doesn't exist or was already closed","resolution":"This may indicate a client protocol error or race condition. Check if the client is sending data after stream closure."},{"function":"on_stream_close_cb","message_template":"closing with err=%d %s","reason":"Closing a stream with an error code","resolution":"Check the specific error code to determine if it indicates a client issue or server limitation. May require configuration changes based on the specific error."},{"function":"on_header_cb","message_template":"on_header unknown stream","reason":"Received headers for a stream that doesn't exist","resolution":"This indicates a client protocol error. The connection may be reset if this occurs frequently."},{"function":"on_header_cb","message_template":"RST stream, header failures: %d","reason":"Too many header parsing failures for a stream, causing it to be reset","resolution":"The client is sending malformed headers. Check for client bugs or possibly malicious behavior if this occurs frequently."},{"function":"on_frame_recv_cb","message_template":"recv FRAME[%s], frames=%ld\/%ld (r\/s)","reason":"Debug message showing a received frame","resolution":"Informational message, no resolution required"},{"function":"on_frame_recv_cb","message_template":"recv FRAME[%s], frames=%ld\/%ld (r\/s), remote.emitted=%d","reason":"Debug message showing a received frame with emission count","resolution":"Informational message, no resolution required"},{"function":"on_frame_recv_cb","message_template":"DATA, len=%ld, flags=%d","reason":"Debug message showing details of a received DATA frame","resolution":"Informational message, no resolution required"},{"function":"on_frame_recv_cb","message_template":"PRIORITY frame  weight=%d, dependsOn=%d, exclusive=%d","reason":"Debug message showing details of a received PRIORITY frame","resolution":"Informational message, no resolution required"},{"function":"on_frame_recv_cb","message_template":"WINDOW_UPDATE incr=%d","reason":"Debug message showing window size increment from a WINDOW_UPDATE frame","resolution":"Informational message, no resolution required"},{"function":"on_frame_recv_cb","message_template":"RST_STREAM by client, error=%d","reason":"Client has reset a stream with specified error code","resolution":"This is normal client behavior when a request is cancelled. If occurring frequently without user action, check client implementation."},{"function":"on_frame_recv_cb","message_template":"SETTINGS, len=%ld","reason":"Debug message showing length of received SETTINGS frame","resolution":"Informational message, no resolution required"},{"function":"on_frame_recv_cb","message_template":"on_frame_rcv %s","reason":"Debug message for frame reception","resolution":"Informational message, no resolution required"},{"function":"on_frame_recv_cb","message_template":"idle_delays","reason":"Debug message related to idle connection management","resolution":"Informational message, no resolution required"},{"function":"on_frame_recv_cb","message_template":"session has %ld idle frames","reason":"Debug message showing number of idle frames on a session","resolution":"Informational message, no resolution required"},{"function":"on_send_data_cb","message_template":"send_data, stream not found","reason":"Attempted to send data on a stream that no longer exists","resolution":"Usually a race condition where a stream was closed while data was being prepared. No action needed unless it occurs frequently."},{"function":"on_send_data_cb","message_template":"send_data_cb for %ld bytes","reason":"Debug message showing bytes being sent","resolution":"Informational message, no resolution required"},{"function":"on_send_data_cb","message_template":"writing frame header","reason":"Error occurred while writing HTTP\/2 frame header","resolution":"Check for connection issues or client disconnections if this happens frequently."},{"function":"on_send_data_cb","message_template":"send_data_cb, reading stream","reason":"Error occurred while reading from the stream to send data","resolution":"Check for server-side stream processing issues or resource limitations."},{"function":"on_send_data_cb","message_template":"send_data_cb, wanted %ld bytes, got %ld from stream","reason":"Stream provided fewer bytes than requested for sending","resolution":"This may indicate internal stream processing errors or premature stream end. Check if the origin handler is functioning correctly."},{"function":"on_send_data_cb","message_template":"sent data length=%ld, total=%ld","reason":"Debug message showing data sent statistics","resolution":"Informational message, no resolution required"},{"function":"on_send_data_cb","message_template":"failed send_data_cb","reason":"Error occurred during data sending callback","resolution":"Check for connection issues, file system problems, or resource limitations based on the accompanying error message."},{"function":"on_frame_send_cb","message_template":"sent FRAME[%s], frames=%ld\/%ld (r\/s)","reason":"Debug message showing a frame being sent","resolution":"Informational message, no resolution required"},{"function":"on_invalid_header_cb","message_template":"invalid header '%.*s: %.*s'","reason":"Client sent an invalid HTTP header","resolution":"The client implementation has a bug. The connection will enforce HTTP\/2 protocol compliance and reset the stream if needed."},{"function":"select_padding_cb","message_template":"select padding from [%d, %d]: %d (frame length: 0x%04x, write size: %d)","reason":"Debug message detailing frame padding selection","resolution":"Informational message, no resolution required"},{"function":"init_callbacks","message_template":"nghttp2_session_callbacks_new: %s","reason":"Error initializing HTTP\/2 session callbacks","resolution":"This indicates an internal server error, possibly due to resource limitations. Check memory usage and server loads."},{"function":"update_child_status","message_template":": stream %d, %s %s","reason":"Status update for MPM scoreboard","resolution":"Informational message, no resolution required"},{"function":"update_child_status","message_template":"[%d\/%d] %s%s","reason":"Status update for MPM scoreboard with stream counts","resolution":"Informational message, no resolution required"},{"function":"h2_session_shutdown_notice","message_template":"sent shutdown notice","reason":"Server sent HTTP\/2 GOAWAY frame with max stream ID to indicate no new streams","resolution":"This is normal during graceful shutdown. No action needed."},{"function":"h2_session_shutdown","message_template":"remote close","reason":"Client closed the connection unexpectedly","resolution":"Normal when clients disconnect. Check for networking issues if occurring frequently without user action."},{"function":"h2_session_shutdown","message_template":"sent GOAWAY, err=%d, msg=%s","reason":"Server sent GOAWAY frame to client with error code and message","resolution":"This is part of HTTP\/2 connection shutdown process. Check the error code and message to determine if action is needed."},{"function":"session_cleanup","message_template":"pool_cleanup","reason":"Debug message for session pool cleanup","resolution":"Informational message, no resolution required"},{"function":"session_cleanup","message_template":"in flight","reason":"Debug message related to in-flight operations during cleanup","resolution":"Informational message, no resolution required"},{"function":"session_cleanup","message_template":"connection disappeared without proper goodbye, clients will be confused, should not happen","reason":"Connection is being closed without sending a proper GOAWAY frame","resolution":"This indicates an abnormal connection termination. Check for server crashes, abrupt process termination, or configuration issues that might cause premature connection closure."},{"function":"session_cleanup","message_template":"cleanup, resetting %d streams in ready-to-process","reason":"Debug message showing streams being reset during cleanup","resolution":"Informational message, no resolution required"},{"function":"session_pool_cleanup","message_template":"session cleanup triggered by pool cleanup. this should have happened earlier already.","reason":"Session cleanup happening during pool cleanup rather than normal shutdown","resolution":"This might indicate memory leaks or improper connection handling. Check server configuration and custom modules for proper cleanup procedures."},{"function":"h2_session_create","message_template":"nghttp2: error in init_callbacks","reason":"Error initializing HTTP\/2 session callbacks","resolution":"This indicates a critical internal error. Check server resource availability and restart the server if needed."},{"function":"h2_session_create","message_template":"nghttp2_option_new: %s","reason":"Error creating HTTP\/2 session options","resolution":"This indicates a critical internal error. Check server resource availability and restart the server if needed."},{"function":"h2_session_create","message_template":"nghttp2_session_server_new: %s","reason":"Error creating HTTP\/2 session server context","resolution":"This indicates a critical internal error, likely a memory allocation failure. Check system resources and server limits."},{"function":"h2_session_create","message_template":"created, max_streams=%d, stream_mem=%d, workers_limit=%d, workers_max=%d, push_diary(type=%d,N=%d), max_data_frame_len=%d","reason":"Debug message showing HTTP\/2 session creation parameters","resolution":"Informational message, no resolution required"},{"function":"h2_session_start","message_template":"HTTP2-Settings","reason":"Debug message related to HTTP\/2 settings","resolution":"Informational message, no resolution required"},{"function":"h2_session_start","message_template":"HTTP2-Settings header missing in request","reason":"Required HTTP2-Settings header is missing during h2c upgrade","resolution":"Client made an invalid HTTP\/2 upgrade request. This indicates a client implementation error. No server action needed."},{"function":"h2_session_start","message_template":"upgrading h2c session with HTTP2-Settings: %s -> %s (%d)","reason":"Debug message showing HTTP\/2 upgrade with settings","resolution":"Informational message, no resolution required"},{"function":"h2_session_start","message_template":"nghttp2_session_upgrade: %s","reason":"Error during HTTP\/2 session upgrade","resolution":"Client sent invalid HTTP\/2 settings during upgrade. This is a client error. Check if particular clients are causing this repeatedly."},{"function":"h2_session_start","message_template":"open stream 1: %s","reason":"Error opening initial HTTP\/2 stream","resolution":"This indicates an internal server error during HTTP\/2 protocol initialization. Check resource availability and server configuration."},{"function":"h2_session_start","message_template":"start, INITIAL_WINDOW_SIZE=%ld, MAX_CONCURRENT_STREAMS=%d","reason":"Debug message showing HTTP\/2 session starting parameters","resolution":"Informational message, no resolution required"},{"function":"h2_session_start","message_template":"nghttp2_submit_settings: %s","reason":"Error submitting HTTP\/2 settings","resolution":"This indicates an internal server error during HTTP\/2 protocol initialization. Check resource availability and server configuration."},{"function":"h2_session_start","message_template":"nghttp2_submit_window_update: %s","reason":"Error submitting HTTP\/2 window update","resolution":"This indicates an internal server error during HTTP\/2 protocol initialization. Check resource availability and server configuration."},{"function":"h2_session_push","message_template":"submitting push promise fail: %s","reason":"Failed to submit an HTTP\/2 server push promise","resolution":"This could be due to client settings rejecting pushes or internal server constraints. Check if server push is enabled and properly configured."},{"function":"h2_session_push","message_template":"SERVER_PUSH %d for %s %s on %d","reason":"Debug message showing HTTP\/2 server push details","resolution":"Informational message, no resolution required"},{"function":"h2_session_push","message_template":"failed to create stream obj %d","reason":"Failed to create stream object for HTTP\/2 push","resolution":"This may indicate server resource constraints. Check memory usage and server limits if this occurs frequently."},{"function":"h2_session_set_prio","message_template":"lookup of nghttp2_stream failed","reason":"Failed to find HTTP\/2 stream during priority setting","resolution":"This may indicate a race condition where a stream was closed while still being processed. Usually harmless unless occurring frequently."},{"function":"h2_session_set_prio","message_template":"PUSH BEFORE, weight=%d, depends=%d, returned=%d","reason":"Debug message showing HTTP\/2 priority configuration for push","resolution":"Informational message, no resolution required"},{"function":"h2_session_set_prio","message_template":"PUSH %s, weight=%d, depends=%d, returned=%d","reason":"Debug message showing HTTP\/2 priority configuration for push","resolution":"Informational message, no resolution required"},{"function":"h2_session_send","message_template":"nghttp2_session_send: %d","reason":"Debug message showing result of HTTP\/2 session send operation","resolution":"Informational message, no resolution required"},{"function":"on_stream_input","message_template":"on_input change","reason":"Debug message for stream input state change","resolution":"Informational message, no resolution required"},{"function":"on_stream_input","message_template":"read","reason":"Debug message indicating read operation","resolution":"Informational message, no resolution required"},{"function":"on_stream_output","message_template":"on_output change","reason":"Debug message for stream output state change","resolution":"Informational message, no resolution required"},{"function":"on_stream_output","message_template":"write","reason":"Debug message indicating write operation","resolution":"Informational message, no resolution required"},{"function":"transit","message_template":"transit [%s] -- %s --> [%s]","reason":"Debug message showing HTTP\/2 session state transition","resolution":"Informational message, no resolution required"},{"function":"transit","message_template":"enter idle","reason":"Debug message indicating session entering idle state","resolution":"Informational message, no resolution required"},{"function":"transit","message_template":"enter keepalive","reason":"Debug message indicating session entering keepalive state","resolution":"Informational message, no resolution required"},{"function":"h2_session_ev_init","message_template":"init","reason":"Debug message for session initialization","resolution":"Informational message, no resolution required"},{"function":"h2_session_ev_input_pending","message_template":"input read","reason":"Debug message for pending input event","resolution":"Informational message, no resolution required"},{"function":"h2_session_ev_input_exhausted","message_template":"input exhausted, no streams","reason":"Debug message indicating input exhaustion with no streams","resolution":"Informational message, no resolution required"},{"function":"h2_session_ev_input_exhausted","message_template":"input exhausted","reason":"Debug message indicating input exhaustion","resolution":"Informational message, no resolution required"},{"function":"h2_session_ev_input_exhausted","message_template":"input exhausted, no streams","reason":"Debug message indicating input exhaustion with no streams","resolution":"Informational message, no resolution required"},{"function":"h2_session_ev_local_goaway","message_template":"local goaway","reason":"Debug message for local GOAWAY event","resolution":"Informational message, no resolution required"},{"function":"h2_session_ev_remote_goaway","message_template":"remote goaway","reason":"Debug message for remote GOAWAY event","resolution":"Informational message, no resolution required"},{"function":"h2_session_ev_conn_error","message_template":"conn error","reason":"Debug message for connection error event","resolution":"Check the specific error for troubleshooting information. May be related to network issues or client disconnection."},{"function":"h2_session_ev_conn_error","message_template":"conn error -> shutdown, remote.emitted=%d","reason":"Connection error causing session shutdown","resolution":"Check the specific error for troubleshooting information. May be related to network issues or client disconnection."},{"function":"h2_session_ev_proto_error","message_template":"proto error -> shutdown","reason":"Protocol error causing session shutdown","resolution":"This indicates an HTTP\/2 protocol violation. Check client conformance and consider whether server settings need adjustment."},{"function":"h2_session_ev_ngh2_done","message_template":"nghttp2 done","reason":"Debug message indicating nghttp2 processing completion","resolution":"Informational message, no resolution required"},{"function":"h2_session_ev_no_more_streams","message_template":"no more streams","reason":"Debug message indicating no streams remaining","resolution":"Informational message, no resolution required"},{"function":"h2_session_ev_no_more_streams","message_template":"all streams done","reason":"Debug message indicating all streams completed","resolution":"Informational message, no resolution required"},{"function":"h2_session_ev_no_more_streams","message_template":"no more streams","reason":"Debug message indicating no streams remaining","resolution":"Informational message, no resolution required"},{"function":"h2_session_dispatch_event","message_template":"schedule","reason":"Debug message for event scheduling","resolution":"Informational message, no resolution required"},{"function":"ev_stream_closed","message_template":"adding h2_eos to c1 out","reason":"Debug message for end-of-stream marker addition","resolution":"Informational message, no resolution required"},{"function":"on_stream_state_enter","message_template":"entered state","reason":"Debug message for stream state transition","resolution":"Informational message, no resolution required"},{"function":"on_stream_state_enter","message_template":"remote close missing","reason":"Stream output closed but remote end hasn't closed input","resolution":"This may indicate a client that isn't properly handling stream closure. The server will reset the stream to release resources."},{"function":"on_stream_state_enter","message_template":"done","reason":"Debug message indicating stream completion","resolution":"Informational message, no resolution required"},{"function":"h2_session_dispatch_event","message_template":"unknown event %d","reason":"Received an unknown event type","resolution":"This indicates an internal programming error. Report to Apache maintainers if seen in logs."},{"function":"h2_session_process","message_template":"process start, async=%d","reason":"Debug message for session processing start","resolution":"Informational message, no resolution required"},{"function":"h2_session_start","message_template":"started on %s:%d","reason":"Debug message for HTTP\/2 session start on a specific host and port","resolution":"Informational message, no resolution required"},{"function":"h2_session_process","message_template":"scheduled stream","reason":"Debug message for stream scheduling","resolution":"Informational message, no resolution required"},{"function":"h2_session_process","message_template":"forwarded input","reason":"Debug message for input forwarding","resolution":"Informational message, no resolution required"},{"function":"h2_session_process","message_template":"unblocked output","reason":"Debug message for output unblocking","resolution":"Informational message, no resolution required"},{"function":"h2_session_process","message_template":"returning to mpm c1 monitoring","reason":"Debug message for returning control to MPM","resolution":"Informational message, no resolution required"},{"function":"h2_session_process","message_template":"polling timeout=%d","reason":"Debug message for polling with timeout","resolution":"Informational message, no resolution required"},{"function":"h2_session_process","message_template":"c1 io pending","reason":"Debug message for pending I\/O on main connection","resolution":"Informational message, no resolution required"},{"function":"h2_session_process","message_template":"streams really done","reason":"Debug message confirming stream completion","resolution":"Informational message, no resolution required"},{"function":"h2_session_process","message_template":"BLOCKED, return to mpm c1 monitoring","reason":"Debug message for blocked state returning to MPM","resolution":"Informational message, no resolution required"},{"function":"h2_session_process","message_template":"polling timeout=%d, open_streams=%d","reason":"Debug message for polling with timeout and open stream count","resolution":"Informational message, no resolution required"},{"function":"h2_session_process","message_template":"unknown state","reason":"Session is in an unknown state","resolution":"This indicates an internal programming error. Report to Apache maintainers if seen in logs."},{"function":"h2_session_process","message_template":"process returns, keepalive=%d","reason":"Debug message for process return with keepalive status","resolution":"Informational message, no resolution required"},{"function":"h2_session_process","message_template":"done","reason":"Debug message indicating processing completion","resolution":"Informational message, no resolution required"},{"function":"h2_session_process","message_template":"error","reason":"Generic error message during processing","resolution":"Check server logs for more specific error information to diagnose the issue."},{"function":"h2_session_pre_close","message_template":"pre_close","reason":"Debug message for pre-close operation","resolution":"Informational message, no resolution required"},{"function":"h2_session_ev_conn_timeout","message_template":"timeout","reason":"Connection timeout occurred","resolution":"This is a normal event for idle connections. No action needed unless occurring for active connections, which might indicate network issues."},{"function":"h2_session_pre_close","message_template":"pre_close","reason":"Debug message for pre-close operation","resolution":"Informational message, no resolution required"}],"project":"apache\/httpd"}