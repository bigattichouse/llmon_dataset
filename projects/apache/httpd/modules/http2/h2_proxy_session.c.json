{"module":"h2_proxy_session.c","summary":"This module implements HTTP\/2 proxy session management for Apache HTTP Server, handling connections to backend HTTP\/2 servers by maintaining streams, processing frames, and managing request\/response data flow using the nghttp2 library.","logs":[{"function":"proxy_session_pre_close","message_template":"proxy_session(%s): pool cleanup, state=%d, streams=%d","reason":"Logs connection cleanup details when a proxy session is being closed, including the session ID, state, and active stream count.","resolution":"This is an informational message during normal cleanup. No resolution required unless there are unexpected stream counts."},{"function":"proxy_pass_brigade","message_template":"pass output failed to %pI (%s)","reason":"Indicates a failure when passing output data to a backend server, showing the IP address and hostname.","resolution":"Check network connectivity to the backend server and ensure it's functioning properly. May indicate backend server timeout or connection issues."},{"function":"raw_send","message_template":"h2_proxy_sesssion(%s): raw_send %d bytes, flush=%d","reason":"Debug message showing raw data being sent to the backend server, including byte count and flush status.","resolution":"Informational log, no resolution required."},{"function":"on_frame_recv","message_template":"h2_proxy_session(%s): recv FRAME[%s]","reason":"Logs received HTTP\/2 frames from the backend server with frame details.","resolution":"Informational log, no resolution required."},{"function":"on_frame_recv","message_template":"h2_proxy_session(%s): got interim HEADERS, status=%d, will forward=%d","reason":"Logs interim response headers received from the backend server, indicating whether they will be forwarded to the client.","resolution":"Informational log, no resolution required."},{"function":"before_frame_send","message_template":"h2_proxy_session(%s): sent FRAME[%s]","reason":"Logs HTTP\/2 frames being sent to the backend server with frame details.","resolution":"Informational log, no resolution required."},{"function":"h2_proxy_stream_add_header_out","message_template":"h2_proxy_stream(%s-%d): got status %s","reason":"Logs the HTTP status code received from the backend server for a specific stream.","resolution":"Informational log, no resolution required unless the status code indicates an error."},{"function":"h2_proxy_stream_add_header_out","message_template":"h2_proxy_stream(%s-%d): on_header %s: %s","reason":"Logs header name-value pairs received from the backend server for a specific stream.","resolution":"Informational log, no resolution required."},{"function":"h2_proxy_stream_add_header_out","message_template":"h2_proxy_stream(%s-%d): got header %s: %s","reason":"Logs normalized header name-value pairs after processing from the backend server.","resolution":"Informational log, no resolution required."},{"function":"log_header","message_template":"h2_proxy_stream(%s-%d), header_out %s: %s","reason":"Logs outgoing headers being sent to the client after processing.","resolution":"Informational log, no resolution required."},{"function":"h2_proxy_stream_end_headers_out","message_template":"h2_proxy_stream(%s-%d), header_out after merging","reason":"Indicates headers have been merged and are ready to be sent to the client.","resolution":"Informational log, no resolution required."},{"function":"stream_response_data","message_template":"h2_proxy_session(%s): recv data chunk for unknown stream %d, ignored","reason":"Logs when data is received for a stream that doesn't exist in the session, likely due to a race condition or server error.","resolution":"This might indicate a protocol error or timing issue. Check for premature stream closures or backend server errors."},{"function":"stream_response_data","message_template":"h2_proxy_session(%s): stream=%d, response DATA %ld, %ld total","reason":"Logs response data received from the backend server for a specific stream, showing chunk size and total received so far.","resolution":"Informational log, no resolution required."},{"function":"stream_response_data","message_template":"h2_proxy_session(%s): passing output on stream %d","reason":"Logs an error while passing response data to the client, which might indicate client disconnection or error.","resolution":"Check client connection status and verify if the client closed the connection prematurely."},{"function":"on_stream_close","message_template":"h2_proxy_session(%s): stream=%d, closed, err=%d","reason":"Logs when an HTTP\/2 stream is closed, including any error code if present.","resolution":"If error code is non-zero, investigate the specific HTTP\/2 error code to determine the cause of stream termination."},{"function":"stream_request_data","message_template":"h2_proxy_stream(NULL): data_read, stream %d not found","reason":"Logs an error when trying to read request data for a stream that doesn't exist.","resolution":"This indicates a protocol error or timing issue. Check for mismanaged stream IDs or premature stream closures."},{"function":"stream_request_data","message_template":"h2_proxy_stream(%s-%d): request body read","reason":"Debug message showing request body data is being read from client for a specific stream.","resolution":"Informational log, no resolution required."},{"function":"stream_request_data","message_template":"h2_proxy_stream(%d): request DATA %ld, %ld total, flags=%d","reason":"Logs request data being sent to the backend server, showing chunk size, total sent so far, and data flags.","resolution":"Informational log, no resolution required."},{"function":"stream_request_data","message_template":"h2_proxy_stream(%d): submit trailers","reason":"Logs when request trailers are being submitted to the backend server.","resolution":"Informational log, no resolution required."},{"function":"stream_request_data","message_template":"h2_proxy_stream(%s-%d): suspending","reason":"Indicates a stream is being suspended, typically due to flow control or waiting for events like 100-continue responses.","resolution":"Informational log, no resolution required. If many streams are suspended, check for backend server performance issues."},{"function":"on_invalid_header_cb","message_template":"h2_proxy_session(%s-%d): denying stream with invalid header '%s: %s'","reason":"Logs when a stream is rejected due to invalid HTTP headers, showing the problematic header.","resolution":"Check the client request for malformed headers and correct the client application if necessary."},{"function":"h2_proxy_session_setup","message_template":"setup session for %s","reason":"Logs when a new HTTP\/2 proxy session is being set up for a backend server.","resolution":"Informational log, no resolution required."},{"function":"open_stream","message_template":"authority=%s from uri.hostname=%s and uri.port=%d","reason":"Debug message showing how the HTTP\/2 authority header value is constructed.","resolution":"Informational log, no resolution required."},{"function":"submit_stream","message_template":"h2_proxy_session(%s): submit %s%s -> %d","reason":"Logs when a new stream is submitted to the backend server, showing the authority, path, and assigned stream ID.","resolution":"Informational log, no resolution required."},{"function":"feed_brigade","message_template":"h2_proxy_session(%s): feeding %ld bytes -> %ld","reason":"Debug message showing raw data being fed to the nghttp2 library, with input and processed byte counts.","resolution":"Informational log, no resolution required."},{"function":"feed_brigade","message_template":"h2_proxy_session(%s): fed %ld bytes of input to session","reason":"Summary log showing total bytes processed from the input brigade.","resolution":"Informational log, no resolution required."},{"function":"h2_proxy_session_read","message_template":"h2_proxy_session(%s): unable to get conn socket","reason":"Error indicating the proxy couldn't access the connection socket, preventing timeout configuration.","resolution":"This could indicate an internal Apache configuration issue. Check for customizations affecting socket handling."},{"function":"h2_proxy_session_read","message_template":"h2_proxy_session(%s): read from conn","reason":"Debug message showing data is being read from the backend connection.","resolution":"Informational log, no resolution required."},{"function":"h2_proxy_session_read","message_template":"h2_proxy_session(%s): read error","reason":"Logs when an error occurs while reading data from the backend connection.","resolution":"Check network connectivity and backend server status. May indicate backend server closed the connection or network issues."},{"function":"h2_proxy_session_submit","message_template":"process stream(%d): %s %s%s, original: %s","reason":"Logs details about a request being proxied, showing method, authority, path, and original request line.","resolution":"Informational log, no resolution required."},{"function":"stream_resume","message_template":"h2_proxy_stream(%s-%d): resuming","reason":"Logs when a previously suspended stream is being resumed.","resolution":"Informational log, no resolution required."},{"function":"check_suspended","message_template":"h2_proxy_stream(%s-%d): check input","reason":"Logs an error when checking for input data on a suspended stream.","resolution":"This could indicate a client connection issue. Check client connectivity and request validity."},{"function":"state_name","message_template":"unknown","reason":"Debug message used when a session state value is outside the expected range.","resolution":"This could indicate a memory corruption or logic error in the code. Report if observed frequently."},{"function":"transit","message_template":"h2_proxy_session(%s): transit [%s] -- %s --> [%s]","reason":"Logs session state transitions, showing previous state, action, and new state.","resolution":"Informational log, no resolution required unless showing unexpected transitions."},{"function":"ev_conn_error","message_template":"h2_proxy_session(%s): conn error -> shutdown","reason":"Logs when a connection error triggers session shutdown.","resolution":"Check network connectivity and backend server status. May indicate backend server issues or network problems."},{"function":"ev_proto_error","message_template":"h2_proxy_session(%s): proto error -> shutdown","reason":"Logs when a protocol error triggers session shutdown.","resolution":"This indicates HTTP\/2 protocol issues between proxy and backend. Check for compatibility issues or backend server errors."},{"function":"ev_no_io","message_template":"h2_proxy_session(%s): WAIT read, timeout=%fms","reason":"Debug message showing a timeout being applied to a blocking read operation.","resolution":"Informational log, no resolution required."},{"function":"dispatch_event","message_template":"h2_proxy_session(%s): unknown event %d","reason":"Logs when an unknown event type is dispatched to the session state machine.","resolution":"This indicates a programming error or corruption. Report as a bug if observed."},{"function":"send_loop","message_template":"h2_proxy_session(%s): write, rv=%d","reason":"Logs an error returned by nghttp2 when writing data to the backend server.","resolution":"Check backend server status and network connectivity. The error code can provide specific details about the failure."},{"function":"h2_proxy_session_process","message_template":"h2_proxy_session(%s): process","reason":"Debug message showing the session processing loop is running.","resolution":"Informational log, no resolution required."},{"function":"h2_proxy_session_process","message_template":"h2_proxy_session(%s): unknown state %d","reason":"Logs when the session enters an unknown or invalid state.","resolution":"This indicates a programming error or memory corruption. Report as a bug if observed."},{"function":"h2_proxy_session_cancel_all","message_template":"h2_proxy_session(%s): cancel %d streams","reason":"Logs when all streams in a session are being canceled, showing the count of affected streams.","resolution":"This usually happens during server shutdown or connection errors. No resolution needed unless occurring unexpectedly."},{"function":"h2_proxy_session_cleanup","message_template":"h2_proxy_session(%s): terminated, %d streams unfinished","reason":"Logs when a session is being cleaned up with streams still in progress, showing the count of unfinished streams.","resolution":"This could indicate premature connection termination. Check for backend server issues or network problems if occurring frequently."},{"function":"ping_arrived","message_template":"h2_proxy_session(%s): ping arrived, unblocking streams","reason":"Logs when PING response is received from backend, causing suspended streams to be unblocked.","resolution":"Informational log, no resolution required."}],"project":"apache\/httpd"}