{"module":"h2_mplx.c","summary":"Manages HTTP\/2 multiplexing functionality, handling stream processing across worker threads, connection contexts, and resource allocation. Implements DoS protection through dynamic worker limits and provides mechanisms for polling stream events, managing input\/output beams between primary and secondary connections.","logs":[{"function":"m_stream_cleanup","message_template":"cleanup, unsubscribing from beam events","reason":"Trace log when cleaning up a stream and removing event subscriptions from bucket beams","resolution":"Informational log, no resolution required"},{"function":"m_stream_cleanup","message_template":"cleanup, removing from registries","reason":"Trace log when removing stream from internal registries during cleanup","resolution":"Informational log, no resolution required"},{"function":"m_stream_cleanup","message_template":"cleanup, c2 is done, move to spurge","reason":"Trace log when a stream's secondary connection (c2) is done processing and the stream is moved to the 'spurge' array for final cleanup","resolution":"Informational log, no resolution required"},{"function":"m_stream_cleanup","message_template":"cleanup, c2 is running, abort","reason":"Trace log when cleaning up a stream whose secondary connection (c2) is still running, triggering an abort","resolution":"May indicate a premature stream closure, check for client disconnection or timeout"},{"function":"m_stream_cleanup","message_template":"cleanup, c2 is done, move to shold","reason":"Trace log when a stream's secondary connection (c2) is done and the stream is moved to the 'shold' hash for later cleanup","resolution":"Informational log, no resolution required"},{"function":"m_stream_cleanup","message_template":"cleanup, never started, move to spurge","reason":"Trace log when cleaning up a stream that was never started and moving it to the 'spurge' array","resolution":"May indicate a problem with stream scheduling or stream creation; check for resource constraints"},{"function":"c2_transit_create","message_template":"h2_mplx: create transit pool","reason":"Error log when failing to create a memory pool for a secondary connection transit","resolution":"Check server memory resources and allocator configuration; may require increasing available memory"},{"function":"mplx_pollset_create","message_template":"nghttp2: could not create pollset","reason":"Error log when failing to create a pollset for handling I\/O events","resolution":"Check for system resource limits, possibly increase file descriptor limits or available memory"},{"function":"m_report_stream_iter","message_template":"started=%d, scheduled=%d, ready=%d, out_buffer=%ld","reason":"Warning log showing diagnostic information about a stream's state during troubleshooting","resolution":"Used for debugging; check the specific values to understand the state of the problematic stream"},{"function":"m_report_stream_iter","message_template":"->03198: %s %s %s","reason":"Debug log showing HTTP request details (method, authority, path) for a stream during troubleshooting","resolution":"Informational log for debugging; no resolution required"},{"function":"m_report_stream_iter","message_template":"[started=%u\/done=%u]","reason":"Debug log showing stream processing state flags during troubleshooting","resolution":"Informational log for debugging; no resolution required"},{"function":"m_report_stream_iter","message_template":"->03198: not started","reason":"Debug log indicating a stream that has not been started during troubleshooting","resolution":"Check for stream scheduling issues or worker resource availability"},{"function":"m_unexpected_stream_iter","message_template":"unexpected, started=%d, scheduled=%d, ready=%d","reason":"Warning log for a stream in an unexpected state, typically during connection cleanup","resolution":"May indicate a bug in stream lifecycle management; check for leaked streams or improper cleanup"},{"function":"h2_mplx_c1_destroy","message_template":"start release","reason":"Trace log at the beginning of multiplexer connection release process","resolution":"Informational log, no resolution required"},{"function":"h2_mplx_c1_destroy","message_template":"release, %u\/%u\/%d streams (total\/hold\/purge), %d streams","reason":"Trace log showing stream counts during multiplexer release","resolution":"Informational log, high counts in hold or purge could indicate pending stream cleanup issues"},{"function":"h2_mplx_c1_destroy","message_template":"waited %u sec for %u streams","reason":"Debug log when waiting for streams to complete during connection cleanup","resolution":"If persistent, check for long-running requests that don't complete properly or deadlocks in stream processing"},{"function":"h2_mplx_c1_destroy","message_template":"unexpected %u streams in hold","reason":"Warning log when there are still streams in hold state during final cleanup","resolution":"Indicates streams that didn't complete normally; check for aborted requests or worker issues"},{"function":"h2_mplx_c1_destroy","message_template":"released","reason":"Trace log when multiplexer release process is complete","resolution":"Informational log, no resolution required"},{"function":"h2_mplx_c1_stream_cleanup","message_template":"cleanup","reason":"Trace log at the start of stream cleanup process","resolution":"Informational log, no resolution required"},{"function":"h2_mplx_c1_reprioritize","message_template":"reprioritize streams","reason":"Trace log when stream processing priorities are being recalculated","resolution":"Informational log, no resolution required"},{"function":"c1_process_stream","message_template":"process %s%s%s %s%s%s%s","reason":"Trace log showing request details (protocol, method, scheme, authority, path) when processing a stream","resolution":"Informational log, no resolution required"},{"function":"c1_process_stream","message_template":"process, ready already","reason":"Trace log when trying to process a stream that is already ready (has a response)","resolution":"Informational log, no resolution required"},{"function":"c1_process_stream","message_template":"process, added to q","reason":"Trace log when a stream is added to the processing queue","resolution":"Informational log, no resolution required"},{"function":"h2_mplx_c1_process","message_template":"stream %d not found to process","reason":"Trace log when attempting to process a stream that doesn't exist","resolution":"May indicate a race condition or premature stream cleanup; check for client RST_STREAM or aborted connections"},{"function":"h2_mplx_c1_process","message_template":"activate at workers","reason":"Error log when failing to activate worker threads for processing","resolution":"Check worker thread pool configuration and system resources; may indicate thread creation failures"},{"function":"h2_mplx_c1_process","message_template":"child mem=%ld, mplx mem=%ld, session mem=%ld, c1=%ld","reason":"Info log showing memory usage details during request processing (debug builds only)","resolution":"Useful for memory leak debugging; monitor for unexpected growth over time"},{"function":"s_next_c2","message_template":"created new c2","reason":"Trace log when creating a new secondary connection for processing","resolution":"Informational log, no resolution required"},{"function":"c2_prod_done","message_template":"h2_mplx(%s-%d): c2 done","reason":"Trace log when a secondary connection is finished processing","resolution":"Informational log, no resolution required"},{"function":"c2_prod_done","message_template":"h2_mplx(%s-%d): request done, %f ms elapsed","reason":"Trace log showing request processing time when a secondary connection completes","resolution":"Informational log, can be used to identify slow requests"},{"function":"s_c2_done","message_template":"h2_c2(%s-%d): processing finished without final response","reason":"Trace log when a request processed but did not generate a complete response","resolution":"Check for handler errors or module issues that might cause incomplete responses"},{"function":"s_c2_done","message_template":"h2_c2(%s-%d): processing finished with incomplete output","reason":"Trace log when a request finished but the output beam is incomplete","resolution":"Check for premature request termination or handler errors causing partial responses"},{"function":"s_c2_done","message_template":"c2_done, stream open","reason":"Trace log when a secondary connection is done but the stream is still open","resolution":"Informational log, normal part of stream lifecycle"},{"function":"s_c2_done","message_template":"c2_done, in hold","reason":"Trace log when a secondary connection is done and the stream is in hold state","resolution":"Informational log, normal part of stream lifecycle"},{"function":"s_c2_done","message_template":"already in spurge","reason":"Warning log when a stream being processed is already in the purge list","resolution":"Indicates a bug in stream lifecycle management; report to developers"},{"function":"s_c2_done","message_template":"stream should not be in spurge","reason":"Assertion failure when a stream is found in spurge list when it shouldn't be","resolution":"Indicates a serious bug in stream management; report to developers"},{"function":"s_c2_done","message_template":"h2_mplx(%s-%d): c2_done, stream not found","reason":"Warning log when a secondary connection completes but its stream cannot be found","resolution":"May indicate premature stream cleanup; check for race conditions or worker thread issues"},{"function":"s_c2_done","message_template":"stream should still be available","reason":"Assertion failure when a stream cannot be found during c2 completion","resolution":"Indicates a serious bug in stream management; report to developers"},{"function":"workers_shutdown","message_template":"workers shutdown, waking pollset","reason":"Trace log when worker threads are being shut down","resolution":"Informational log, part of normal server shutdown process"},{"function":"s_mplx_be_happy","message_template":"mood update, increasing worker limit to %d","reason":"Trace log when HTTP\/2 connection increases its worker limit due to good performance","resolution":"Informational log, part of DoS protection dynamic adjustment"},{"function":"m_be_annoyed","message_template":"mood update, decreasing worker limit to %d","reason":"Trace log when HTTP\/2 connection decreases its worker limit due to performance issues","resolution":"If frequent, may indicate client behavior causing server to limit resources; check for abusive clients"},{"function":"h2_mplx_c1_client_rst","message_template":"RST on unknown stream %d","reason":"Debug log when receiving a reset on a stream that is no longer tracked","resolution":"Usually benign; late RST_STREAM messages are acceptable"},{"function":"h2_mplx_c1_client_rst","message_template":"very early RST, drop","reason":"Debug log when receiving a reset on a stream very early in its lifecycle","resolution":"May indicate client errors or cancellations; monitor for patterns of excessive early resets"},{"function":"mplx_pollset_poll","message_template":"enter polling timeout=%d","reason":"Trace log at the beginning of pollset polling operation","resolution":"Informational log, no resolution required"},{"function":"mplx_pollset_poll","message_template":"polling timed out","reason":"Trace log when polling operation times out","resolution":"Informational log, normal part of polling cycle"},{"function":"mplx_pollset_poll","message_template":"polling failed","reason":"Error log when pollset polling operation fails","resolution":"Check system resources and file descriptor limits; may indicate resource exhaustion"},{"function":"s_next_c2","message_template":"delaying request processing. Current limit is %d and %d workers are in use.","reason":"Debug log when request processing is delayed due to worker limit constraints","resolution":"If frequent, consider increasing MaxWorkersPerConnection directive or investigating client behavior"},{"function":"c2_setup_io","message_template":"error %s","reason":"Error log when setting up input\/output for a secondary connection fails","resolution":"Check specific error message; usually related to memory allocation or pipe creation issues"}],"project":"apache\/httpd"}