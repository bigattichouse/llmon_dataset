{"module":"authnz_ldap.c","summary":"This module provides authentication and authorization capabilities against LDAP directories. It supports multiple authorization methods including user matching, group membership checking, DN matching, attribute checking, and filter evaluation. It integrates with mod_ldap for LDAP connection handling and operations.","logs":[{"function":"authn_ldap_check_password","message_template":"no AuthLDAPURL","reason":"LDAP authentication was attempted but no LDAP URL was configured. This is a configuration error.","resolution":"Add an AuthLDAPURL directive to your configuration specifying the LDAP server to connect to and search parameters."},{"function":"authn_ldap_check_password","message_template":"auth_ldap authenticate: no password specified","reason":"User attempted to authenticate without providing a password.","resolution":"Check that the client is correctly sending authentication credentials and that the authentication mechanism is properly configured."},{"function":"authn_ldap_check_password","message_template":"auth_ldap authenticate: no user specified","reason":"User attempted to authenticate without providing a username.","resolution":"Check that the client is correctly sending authentication credentials and that the authentication mechanism is properly configured."},{"function":"authn_ldap_check_password","message_template":"auth_ldap authenticate: empty password specified","reason":"User attempted to authenticate with an empty password, which is not allowed.","resolution":"Empty passwords are never accepted by this module. The user must provide a valid non-empty password."},{"function":"authn_ldap_check_password","message_template":"auth_ldap authenticate: no sec->host - weird...?","reason":"Internal configuration error - LDAP host is not set despite having a valid LDAP URL.","resolution":"This indicates a potential bug in the module. Check your AuthLDAPURL directive and report this issue to the developers."},{"function":"authn_ldap_check_password","message_template":"auth_ldap authenticate: using URL %s","reason":"Informational message indicating which LDAP URL is being used for authentication.","resolution":"Information log, no resolution required"},{"function":"authn_ldap_check_password","message_template":"auth_ldap authenticate: ldap filter too long (>%d): %s","reason":"The LDAP filter generated for the authentication query exceeds the maximum allowed length.","resolution":"Simplify the LDAP filter in your AuthLDAPURL or reduce the length of the username being used for authentication."},{"function":"authn_ldap_check_password","message_template":"auth_ldap authenticate: final authn filter is %s","reason":"Debug message showing the final LDAP filter being used for authentication.","resolution":"Information log, no resolution required"},{"function":"authn_ldap_check_password","message_template":"auth_ldap authenticate: user %s authentication failed; URI %s [%s][%s] (not authoritative)","reason":"Authentication failed for the user and the module is configured to not be authoritative, allowing other authentication modules to attempt authentication.","resolution":"If this module should be the final authority for authentication, set AuthLDAPBindAuthoritative to 'on'. Otherwise, ensure other authentication methods are properly configured."},{"function":"authn_ldap_check_password","message_template":"auth_ldap authenticate: user %s authentication failed; URI %s [%s][%s]","reason":"Authentication failed for the user and the module is authoritative, meaning the authentication failure is final.","resolution":"Check that the user exists in the LDAP directory and has provided the correct password. Check LDAP server logs for more details."},{"function":"authn_ldap_check_password","message_template":"auth_ldap authenticate: REMOTE_USER was to be set with attribute '%s', but this attribute was not requested for in the LDAP query for the user. REMOTE_USER will fall back to username or DN as appropriate.","reason":"AuthLDAPRemoteUserAttribute was configured but the specified attribute was not requested in the LDAP query.","resolution":"Add the attribute specified in AuthLDAPRemoteUserAttribute to the attribute list in your AuthLDAPURL."},{"function":"authn_ldap_check_password","message_template":"auth_ldap authenticate: accepting %s","reason":"Successfully authenticated the specified user against the LDAP directory.","resolution":"Information log, no resolution required"},{"function":"get_connection_for_authz","message_template":"module error: get_connection_for_authz without per-request config","reason":"Internal error - authorization was attempted without a valid per-request configuration.","resolution":"This indicates a bug in the module. Report this issue to the developers."},{"function":"get_connection_for_authz","message_template":"Obtain ldc %pp for authz","reason":"Debug message showing LDAP connection handle being obtained for authorization.","resolution":"Information log, no resolution required"},{"function":"build_request_config","message_template":"ldap authorize: Creating LDAP req structure","reason":"Debug message indicating an LDAP request structure is being created for authorization.","resolution":"Information log, no resolution required"},{"function":"ldapuser_check_authorization","message_template":"ldap authorize: Userid is blank, AuthType=%s","reason":"Authorization check was requested, but the userid is blank. This typically indicates missing authentication.","resolution":"Ensure that authentication is properly configured before authorization checks are performed."},{"function":"ldapuser_check_authorization","message_template":"auth_ldap authorize: require user: user's DN has not been defined; failing authorization","reason":"The user's DN could not be determined from the LDAP directory, so authorization is denied.","resolution":"Verify that the user exists in the LDAP directory and that the AuthLDAPURL is correctly configured to find the user."},{"function":"ldapuser_check_authorization","message_template":"auth_ldap authorize: require user: Can't evaluate expression: %s","reason":"Failed to evaluate the expression in the 'require ldap-user' directive.","resolution":"Check the syntax of your 'require ldap-user' directive and ensure all variables are properly defined."},{"function":"ldapuser_check_authorization","message_template":"auth_ldap authorize: require user: authorization successful","reason":"User authorization was successful based on the 'require ldap-user' directive.","resolution":"Information log, no resolution required"},{"function":"ldapuser_check_authorization","message_template":"auth_ldap authorize: require user: authorization failed [%s][%s]","reason":"User authorization failed based on the 'require ldap-user' directive.","resolution":"Verify that the user exists in the LDAP directory and that the attribute specified in the AuthLDAPURL matches the required user value."},{"function":"ldapuser_check_authorization","message_template":"auth_ldap authorize user: authorization denied for user %s to %s","reason":"Summary message indicating the user was denied access to the specified resource.","resolution":"Check that the user has the correct permissions and that all authorization directives are properly configured."},{"function":"ldapgroup_check_authorization","message_template":"auth_ldap authorize: require group: user's DN has not been defined; failing authorization for user %s","reason":"Group authorization failed because the user's DN could not be determined.","resolution":"Verify that the user exists in the LDAP directory and that AuthLDAPURL is correctly configured to find the user."},{"function":"ldapgroup_check_authorization","message_template":"auth_ldap authorize: require group: Can't evaluate expression: %s","reason":"Failed to evaluate the expression in the 'require ldap-group' directive.","resolution":"Check the syntax of your 'require ldap-group' directive and ensure all variables are properly defined."},{"function":"ldapgroup_check_authorization","message_template":"auth_ldap authorize: require group: testing for group membership in \"%s\"","reason":"Debug message indicating which group membership is being tested.","resolution":"Information log, no resolution required"},{"function":"ldapgroup_check_authorization","message_template":"auth_ldap authorize: require group: testing for %s: %s (%s)","reason":"Debug message showing details of the group membership check being performed.","resolution":"Information log, no resolution required"},{"function":"ldapgroup_check_authorization","message_template":"auth_ldap authorize: require group: authorization successful (attribute %s) [%s][%d - %s]","reason":"Group authorization was successful based on the specified attribute.","resolution":"Information log, no resolution required"},{"function":"ldapgroup_check_authorization","message_template":"auth_ldap authorize: require group \"%s\": didn't match with attr %s [%s][%d - %s]","reason":"Group authorization failed because the user is not a member of the specified group.","resolution":"Verify that the user is a member of the required group in the LDAP directory."},{"function":"ldapgroup_check_authorization","message_template":"auth_ldap authorise: require group \"%s\": failed [%s][%d - %s], checking sub-groups","reason":"Group authorization failed on the direct group, now checking sub-groups.","resolution":"Information log, no resolution required"},{"function":"ldapgroup_check_authorization","message_template":"auth_ldap authorise: require group (sub-group): authorisation successful (attribute %s) [%s][%d - %s]","reason":"Group authorization was successful based on sub-group membership.","resolution":"Information log, no resolution required"},{"function":"ldapgroup_check_authorization","message_template":"auth_ldap authorise: require group (sub-group) \"%s\": didn't match with attr %s [%s][%d - %s]","reason":"Group authorization failed because the user is not a member of the specified sub-group.","resolution":"Verify that the user is a member of the required sub-group in the LDAP directory."},{"function":"ldapgroup_check_authorization","message_template":"auth_ldap authorize group: authorization denied for user %s to %s","reason":"Summary message indicating the user was denied access based on group membership.","resolution":"Check that the user is a member of the required group in the LDAP directory."},{"function":"ldapdn_check_authorization","message_template":"auth_ldap authorize: require dn: user's DN has not been defined; failing authorization","reason":"DN authorization failed because the user's DN could not be determined.","resolution":"Verify that the user exists in the LDAP directory and that AuthLDAPURL is correctly configured to find the user."},{"function":"ldapdn_check_authorization","message_template":"auth_ldap authorize: require dn: Can't evaluate expression: %s","reason":"Failed to evaluate the expression in the 'require ldap-dn' directive.","resolution":"Check the syntax of your 'require ldap-dn' directive and ensure all variables are properly defined."},{"function":"ldapdn_check_authorization","message_template":"auth_ldap authorize: require dn: authorization successful","reason":"DN authorization was successful based on the 'require ldap-dn' directive.","resolution":"Information log, no resolution required"},{"function":"ldapdn_check_authorization","message_template":"auth_ldap authorize: require dn \"%s\": LDAP error [%s][%s]","reason":"DN authorization failed due to an LDAP error.","resolution":"Check the LDAP server logs for more details about the error. Verify the DN in the 'require ldap-dn' directive."},{"function":"ldapdn_check_authorization","message_template":"auth_ldap authorize dn: authorization denied for user %s to %s","reason":"Summary message indicating the user was denied access based on DN matching.","resolution":"Check that the user's DN matches the required DN in the 'require ldap-dn' directive."},{"function":"ldapattribute_check_authorization","message_template":"auth_ldap authorize: require ldap-attribute: user's DN has not been defined; failing authorization","reason":"Attribute authorization failed because the user's DN could not be determined.","resolution":"Verify that the user exists in the LDAP directory and that AuthLDAPURL is correctly configured to find the user."},{"function":"ldapattribute_check_authorization","message_template":"auth_ldap authorize: require ldap-attribute: Can't evaluate expression: %s","reason":"Failed to evaluate the expression in the 'require ldap-attribute' directive.","resolution":"Check the syntax of your 'require ldap-attribute' directive and ensure all variables are properly defined."},{"function":"ldapattribute_check_authorization","message_template":"auth_ldap authorize: checking attribute %s has value %s","reason":"Debug message showing which attribute and value is being checked.","resolution":"Information log, no resolution required"},{"function":"ldapattribute_check_authorization","message_template":"auth_ldap authorize: require attribute: authorization successful","reason":"Attribute authorization was successful.","resolution":"Information log, no resolution required"},{"function":"ldapattribute_check_authorization","message_template":"auth_ldap authorize: require attribute: authorization failed [%s][%s]","reason":"Attribute authorization failed because the user does not have the required attribute value.","resolution":"Verify that the user has the required attribute and value in the LDAP directory."},{"function":"ldapattribute_check_authorization","message_template":"auth_ldap authorize attribute: authorization denied for user %s to %s","reason":"Summary message indicating the user was denied access based on attribute checking.","resolution":"Check that the user has the required attributes and values in the LDAP directory."},{"function":"ldapfilter_check_authorization","message_template":"auth_ldap authorize: require ldap-filter: user's DN has not been defined; failing authorization","reason":"Filter authorization failed because the user's DN could not be determined.","resolution":"Verify that the user exists in the LDAP directory and that AuthLDAPURL is correctly configured to find the user."},{"function":"ldapfilter_check_authorization","message_template":"auth_ldap authorize: require ldap-filter: Can't evaluate require expression: %s","reason":"Failed to evaluate the expression in the 'require ldap-filter' directive.","resolution":"Check the syntax of your 'require ldap-filter' directive and ensure all variables are properly defined."},{"function":"ldapfilter_check_authorization","message_template":"auth_ldap authorize: checking filter %s","reason":"Debug message showing which filter is being checked.","resolution":"Information log, no resolution required"},{"function":"ldapfilter_check_authorization","message_template":"auth_ldap authorize: ldap filter too long (>%d): %s","reason":"The LDAP filter generated for the authorization query exceeds the maximum allowed length.","resolution":"Simplify the LDAP filter in your 'require ldap-filter' directive."},{"function":"ldapfilter_check_authorization","message_template":"auth_ldap authorize: checking dn match %s","reason":"Debug message showing which DN is being matched during filter authorization.","resolution":"Information log, no resolution required"},{"function":"ldapfilter_check_authorization","message_template":"auth_ldap authorize: require ldap-filter: authorization successful","reason":"Filter authorization was successful based on the LDAP filter.","resolution":"Information log, no resolution required"},{"function":"ldapfilter_check_authorization","message_template":"auth_ldap authorize: require ldap-filter: %s authorization failed [%s][%s]","reason":"Filter authorization failed due to an LDAP filter error.","resolution":"Check the syntax of your LDAP filter and ensure it is valid. Check the LDAP server logs for more details."},{"function":"ldapfilter_check_authorization","message_template":"auth_ldap authorize: require ldap-filter: authorization failed [%s][%s]","reason":"Filter authorization failed because the user does not match the LDAP filter.","resolution":"Verify that the user matches the required LDAP filter criteria in the directory."},{"function":"ldapfilter_check_authorization","message_template":"auth_ldap authorize filter: authorization denied for user %s to %s","reason":"Summary message indicating the user was denied access based on LDAP filter.","resolution":"Check that the user matches the required LDAP filter criteria in the directory."},{"function":"ldapsearch_check_authorization","message_template":"auth_ldap authorize: require ldap-search: Can't evaluate require expression: %s","reason":"Failed to evaluate the expression in the 'require ldap-search' directive.","resolution":"Check the syntax of your 'require ldap-search' directive and ensure all variables are properly defined."},{"function":"ldapsearch_check_authorization","message_template":"auth_ldap authorize: checking filter %s","reason":"Debug message showing which filter is being used for the LDAP search.","resolution":"Information log, no resolution required"},{"function":"ldapsearch_check_authorization","message_template":"auth_ldap authorize: require ldap-search: authorization successful","reason":"Search authorization was successful based on the LDAP search.","resolution":"Information log, no resolution required"},{"function":"ldapsearch_check_authorization","message_template":"auth_ldap authorize: require ldap-search: %s authorization failed [%s][%s]","reason":"Search authorization failed because the LDAP search did not return a result.","resolution":"Check the LDAP search filter and verify that it matches at least one entry in the directory."},{"function":"ldapsearch_check_authorization","message_template":"auth_ldap authorize search: authorization denied for to %s","reason":"Summary message indicating access was denied based on LDAP search.","resolution":"Check the LDAP search criteria and verify that it matches the expected entries in the directory."},{"function":"ldap_parse_config","message_template":"Cannot parse expression in require line: ","reason":"Failed to parse the expression in a 'require' directive.","resolution":"Check the syntax of your 'require' directive and ensure it is valid."},{"function":"mod_auth_ldap_parse_url","message_template":"auth_ldap url parse: `%s', Host: %s, Port: %d, DN: %s, attrib: %s, scope: %s, filter: %s, connection mode: %s","reason":"Debug message showing the parsed components of the LDAP URL.","resolution":"Information log, no resolution required"},{"function":"set_bind_pattern","message_template":"AuthLDAPInitialBindPattern: cannot compile regular expression '%s'","reason":"Failed to compile the regular expression for the AuthLDAPInitialBindPattern directive.","resolution":"Check the syntax of your regular expression in the AuthLDAPInitialBindPattern directive."},{"function":"set_bind_password","message_template":"Unable to parse exec arguments from ","reason":"Failed to parse the exec arguments for the AuthLDAPBindPassword directive.","resolution":"Check the syntax of your AuthLDAPBindPassword directive with the exec: prefix."},{"function":"set_bind_password","message_template":"Invalid AuthLDAPBindPassword exec location:","reason":"The executable specified for AuthLDAPBindPassword does not exist or is not valid.","resolution":"Verify that the executable path is correct and that the file exists and is executable."},{"function":"set_bind_password","message_template":"Unable to get bind password from exec of ","reason":"Failed to execute the command to retrieve the bind password.","resolution":"Check that the executable can be run by the Apache process and returns a valid password."},{"function":"set_bind_password","message_template":"Empty passwords are invalid for AuthLDAPBindPassword","reason":"The AuthLDAPBindPassword directive resulted in an empty password, which is not allowed.","resolution":"Ensure that the AuthLDAPBindPassword directive or the executable it calls returns a non-empty password."},{"function":"authnz_ldap_post_config","message_template":"LDAP: SSL connections (ldaps:\/\/) not supported by utilLDAP","reason":"LDAP SSL connections were requested but are not supported by the utilLDAP module.","resolution":"Rebuild Apache with SSL support for LDAP or use non-SSL LDAP connections."},{"function":"authnz_ldap_post_config","message_template":"Module mod_ldap missing. Mod_ldap (aka. util_ldap) must be loaded in order for mod_authnz_ldap to function properly","reason":"The mod_ldap module is not loaded, which is required by mod_authnz_ldap.","resolution":"Add 'LoadModule ldap_module modules\/mod_ldap.so' to your Apache configuration."},{"function":"authnz_ldap_post_config","message_template":"Invalid charset conversion config path %s","reason":"The path specified for the charset conversion configuration file is invalid.","resolution":"Check that the path specified in AuthLDAPCharsetConfig is valid and accessible."},{"function":"authnz_ldap_post_config","message_template":"could not open charset conversion config file %s.","reason":"Failed to open the charset conversion configuration file.","resolution":"Verify that the file exists and is readable by the Apache process."},{"function":"authnz_ldap_post_config","message_template":"could not find the UTF-8 charset in the file %s.","reason":"The UTF-8 charset was not found in the charset conversion configuration file.","resolution":"Add a UTF-8 charset definition to your charset conversion configuration file."},{"function":"authnz_ldap_cleanup_connection_close","message_template":"Release ldc %pp","reason":"Debug message indicating an LDAP connection is being released.","resolution":"Information log, no resolution required"}],"project":"apache\/httpd"}